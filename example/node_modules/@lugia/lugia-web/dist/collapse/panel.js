"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_react=require("react"),React=_interopRequireWildcard(_react),_themeProvider=require("../theme-provider"),_themeProvider2=_interopRequireDefault(_themeProvider),_objectUtils=require("@lugia/object-utils"),_themeHoc=require("@lugia/theme-hoc"),_index=require("../consts/index"),_index2=_interopRequireDefault(_index),_panel=require("../css/panel"),_units=require("../css/units"),_icon=require("../icon"),_icon2=_interopRequireDefault(_icon);function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _interopRequireWildcard(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function _defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}_panel.PanelHeader.displayName="Panel",exports.default=(0,_themeProvider2.default)(function(){function t(e){_classCallCheck(this,t);var h=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return h.getIconTheme=function(){var e=h.props.getPartOfThemeHocProps,t=h.state,n=t.opening,r=t.closing,o=t.open,i=e("PanelHeaderIcon"),a=i.viewClass,l=i.theme;return{viewClass:a,theme:(0,_objectUtils.deepMerge)(_defineProperty({},a,{normal:{color:"#666",fontSize:14,getCSS:function(){return"position: absolute;\n                  top: 50%;\n                  left: "+(0,_units.px2remcss)(10)+";\n                  transition: all 0.3s;\n                  "+(0,_panel.getIconTransform)({opening:n,open:o,closing:r})+"\n                "}}}),l)}},h.changeHover=function(e){return function(){h.setState({hover:e})}},h.handlePanelClick=function(e){var t=h.props,n=t.disabled,r=void 0!==n&&n,o=t.value,i=t.onClick;if(!r){var a=h.panel.scrollHeight,l=h.state,s=l.opening,c=l.closing,p=l.open;if(!h.hasOpen()&&(s||c))return;h.height=a;var u={closing:!1,opening:!1};h.hasOpen()?i&&i(o):(h.setState(h.getClickState(p)),setTimeout(function(){u.open=!p,h.setState(u),i&&i(o)},300))}e.preventDefault()},h.hasOpen=function(){return"open"in h.props},h.getClickState=function(e){return e?{closing:!0}:{opening:!0}},h.state={open:void 0,opening:!1,closing:!1,height:0,hover:!1},h.height=0,h}return _inherits(t,React.Component),_createClass(t,[{key:"componentDidMount",value:function(){this.height=this.panel&&this.panel.scrollHeight}},{key:"render",value:function(){var t=this,e=this.state,n=e.opening,r=e.closing,o=e.open,i=e.hover,a=this.props,l=a.disabled,s=void 0!==l&&l,c=a.title,p=a.children,u=a.showArrow,h=void 0===u||u,f=a.getPartOfThemeProps,d=a.dispatchEvent,_=a.themeProps,g={};h||(g.enter=this.changeHover(!0),g.leave=this.changeHover(!1));var v=f("PanelHeader",{props:{hover:i,showArrow:h}}),m=f("PanelHeaderText",{props:{showArrow:h}}),P=f("PanelContent",{props:{showArrow:h,hasChildren:!!p}});return React.createElement(_panel.Wrap,Object.assign({},(0,_themeHoc.addMouseEvent)(this,g),{themeProps:f("Wrap")}),React.createElement(_panel.PanelWrap,null,React.createElement(_panel.PanelHeader,{disabled:s,themeProps:v,onClick:this.handlePanelClick,ref:function(e){return t.header=e}},h||i?React.createElement(_icon2.default,Object.assign({iconClass:"lugia-icon-direction_caret_right"},this.getIconTheme(),d(["hover","disabled"],"f2c"),{singleTheme:!0})):null,React.createElement(_panel.PanelHeaderText,{themeProps:m},c)),React.createElement(_panel.PanelContentWrap,{ref:function(e){return t.panel=e},open:o,opening:n,closing:r,height:this.height,themeProps:_},React.createElement(_panel.PanelContent,{themeProps:P},p))))}},{key:"componentDidUpdate",value:function(){var e=this,t=this.state,n=t.opening,r=t.closing;this.height=this.panel&&this.panel.scrollHeight,!this.hasOpen()||!0!==n&&!0!==r||setTimeout(function(){e.setState({opening:!1,closing:!1})},300)}}],[{key:"getDerivedStateFromProps",value:function(e,t){var n=e.open,r=e.defaultOpen,o="open"in e,i=t.open,a=o?n:t?i:r,l={open:a};return o&&(l.closing=!0===i&&!1===a,l.opening=!1===i&&!0===a),l}}]),t}(),_index2.default.Panel,{hover:!0});