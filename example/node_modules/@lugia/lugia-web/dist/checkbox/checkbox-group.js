"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _class,_temp,_initialiseProps,_createClass=function(){function n(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(e,t,a){return t&&n(e.prototype,t),a&&n(e,a),e}}(),_react=require("react"),React=_interopRequireWildcard(_react),_themeProvider=require("../theme-provider"),_themeProvider2=_interopRequireDefault(_themeProvider),_checkbox=require("./checkbox"),_checkbox2=_interopRequireDefault(_checkbox),_button=require("../check-button/button"),_button2=_interopRequireDefault(_button),_consts=require("../consts"),_consts2=_interopRequireDefault(_consts),_props5=require("../consts/props"),_checkboxGroup=require("../css/checkbox-group"),_translateData=require("../common/translateData"),_theme=require("../theme"),_theme2=_interopRequireDefault(_theme);function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _interopRequireWildcard(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t}function _toConsumableArray(e){if(Array.isArray(e)){for(var t=0,a=Array(e.length);t<e.length;t++)a[t]=e[t];return a}return Array.from(e)}function _defineProperty(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}exports.default=(0,_themeProvider2.default)((_temp=_class=function(){function r(e){_classCallCheck(this,r);var t=_possibleConstructorReturn(this,(r.__proto__||Object.getPrototypeOf(r)).call(this,e));_initialiseProps.call(t);var a=(0,_translateData.getValueAndDisplayValue)(e,null).displayValue,n=a||[];return(0,_translateData.updateMapData)(e,n,t.updateMapData),t}return _inherits(r,React.Component),_createClass(r,[{key:"shouldComponentUpdate",value:function(e,t){var a=this.props,n={props:{displayValue:a.displayValue,value:a.value,data:a.data},state:{dataLength:this.state.dataLength}};return(0,_translateData.didUpdate)(e,t,n,function(e,t){return t.displayValue},this.updateMapData)}},{key:"render",value:function(){var n=this,e=this.props,t=e.cache,a=void 0===t||t,r=e.childType,l=void 0===r?"default":r,i=e.children,o=e.data,u=e.disabled,s=e.styles,c=e.getPartOfThemeProps;a||(0,_translateData.updateMapData)(this.props,this.state.displayValue,this.updateMapData);var d={props:{children:i,data:o,disabled:u,styles:s},state:{value:this.state.value},getChildDom:function(e,t,a){return n.getChildDom(e,t,a)},handleChange:function(){return n.handleChange},hasValueProps:function(){return n.hasValueProps()},cancelItem:this.cancelItem};return React.createElement(_theme2.default,{config:this.getChildTheme()},React.createElement(_checkboxGroup.Group,{themeProps:c("Container"),childType:l},(0,_translateData.handleCreate)(d,"checkbox",l)))}},{key:"hasValueProps",value:function(){return"value"in this.props}},{key:"getChildTheme",value:function(){var e,t=this.props.getPartOfThemeConfig;return _defineProperty(e={},_consts2.default.Checkbox,t("Checkbox")),_defineProperty(e,_consts2.default.CheckButton,t("CheckButton")),e}}],[{key:"getDerivedStateFromProps",value:function(e,t){var a=e.data,n=(void 0===a?[]:a).length,r=(0,_translateData.getValueAndDisplayValue)(e,t),l=r.value,i=r.displayValue;return{value:l||[],displayValue:i||[],dataLength:n}}}]),r}(),_initialiseProps=function(){var b=this;this.updateMapData=function(e){var t=e.cancelItem,a=e.cancelItemData,n=e.dataItem;b.cancelItem=t,b.cancelItemData=a,b.dataItem=n},this.getMapData=function(){return{cancelItem:b.cancelItem,dataItem:b.dataItem,cancelItemData:b.cancelItemData}},this.dataHasItem=function(e){return e in b.dataItem},this.cancelHasItem=function(e){return e in b.cancelItemData},this.needUpdate=function(e){return!b.dataHasItem(e)&&!b.cancelHasItem(e)},this.getChildDom=function(e,t){var a=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},n=b.props,r=n.displayField,l=void 0===r?_props5.DisplayField:r,i=n.valueField,o=void 0===i?_props5.ValueField:i,u=n.disabled,s=n.styles,c=void 0===s?"default":s,d=n.childType,p=void 0===d?"default":d,h=n.size,f=void 0===h?"default":h,_=a.last,m={};t?m.cancel=!0:m.disabled=u||e.disabled;var v=e[o];return"button"===p?React.createElement(_button2.default,Object.assign({key:v,value:v,checked:!!~b.state.value.indexOf(v),onChange:b.handleChange},m,{size:f,hasValue:b.hasValueProps(),handleCancelItemClick:b.handleCancelItemClick}),e[l]):React.createElement(_checkbox2.default,Object.assign({key:v,value:v,checked:!!~b.state.value.indexOf(v),onChangeForGroup:b.handleChange,styles:c},m,{last:_,handleCancelItemClick:b.handleCancelItemClick}),e[l])},this.handleChange=function(e,t){var a=b.props.onChange,n=b.state.value,r=void 0===n?[]:n,l=r,i=[].concat(_toConsumableArray(r)),o=r.indexOf(t);-1<o?i.splice(o,1):i.push(t);var u=void 0,s=void 0,c=void 0;if(!b.props.children){var d={updateHanlder:b.updateMapData,needUpdate:b.needUpdate,getMapData:b.getMapData},p=b.props,h={props:{displayField:p.displayField,children:p.children,data:p.data,valueField:p.valueField,value:p.value,defaultValue:p.defaultValue},state:{displayValue:b.state.displayValue}},f=(0,_translateData.getItems)(i,!0,h,d),_=f.items,m=f.displayValue;u=_,s=(0,_translateData.getItems)(l,!1,h,d).items,c=m}var v={newValue:i,oldValue:l,newItem:u,event:e,oldItem:s,newDisplayValue:c},y=!b.hasValueProps();a&&a(v),y&&b.setState({value:i})},this.handleCancelItemClick=function(e){if(!b.hasValueProps()){var t=b.cancelItemData[e],a=b.cancelItem.indexOf(t);b.cancelItem.splice(a,1)}}},_temp),_consts2.default.CheckboxGroup);