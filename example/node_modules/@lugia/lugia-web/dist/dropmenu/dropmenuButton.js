"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_react=require("react"),React=_interopRequireWildcard(_react),_index=require("../consts/index"),_index2=_interopRequireDefault(_index),_themeProvider=require("../theme-provider"),_themeProvider2=_interopRequireDefault(_themeProvider),_icon=require("../icon"),_icon2=_interopRequireDefault(_icon),_objectUtils=require("@lugia/object-utils"),_dropmenubutton=require("../css/dropmenubutton");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _interopRequireWildcard(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function _defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var DropMenuButton=function(){function n(e){_classCallCheck(this,n);var t=_possibleConstructorReturn(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e));return _initialiseProps.call(t),t.state={hasIconChecked:!1,hasButtonChecked:!1},t}return _inherits(n,React.Component),_createClass(n,[{key:"render",value:function(){return this.props.divided?this.getDevidedButton():this.getNoDevidedButton()}},{key:"onTriggerShow",value:function(e){var t=this.props,n=t.onClick;t.disabled||n&&n(e)}}]),n}();DropMenuButton.displayName=_index2.default.DropMenuButton,DropMenuButton.defaultProps={getTheme:function(){return{}},divided:!1,type:"customs",disabled:!1,switchIconClass:{iconClass:"lugia-icon-direction_down"},showSwitch:!0,icons:{}};var _initialiseProps=function(){var b=this;this.getWrapThemeProps=function(e){var t=b.props,n=t.divided,r=t.type,o=t.getPartOfThemeProps,i=t.disabled;return o("Container",{props:{type:r,checked:b.state.hasButtonChecked,disabled:i,divided:n,dividedThemeConfig:e}})},this.getNoDevidedButton=function(){var e=b.props,t=e.getPartOfThemeProps,n=e.disabled,r=e.switchIconClass,o=e.showSwitch,i=b.getIconTheme("SwitchIcon"),a=i.viewClass,s=i.theme,c=r.iconClass,u=r.iconSrc,d=b.props.createEventChannel(["active","hover","disabled"]);return React.createElement(_dropmenubutton.NoDividedContainer,Object.assign({themeProps:b.getWrapThemeProps(),onClick:b.handleClickWrap,onMouseEnter:b.onMouseEnter,onMouseLeave:b.onMouseLeave},d.provider),React.createElement(_dropmenubutton.CheckInput,{disabled:n,onClick:b.handleLeftButtonClick,type:"button",onBlur:b.handleButtonBlur}),React.createElement(_dropmenubutton.NoDividedWrap,null,b.getPreIcon(d),React.createElement(_dropmenubutton.NoDevidedTextContainer,{lugiaConsumers:d.consumer,themeProps:t("TextContainer",{disabled:n})},b.getText()),b.getSuffixIcon(d),o?React.createElement(_icon2.default,{iconClass:c,src:u,singleTheme:!0,viewClass:a,theme:s,lugiaConsumers:d.consumer}):null))},this.getPreOrSuffixIcon=function(e,t,n,r){var o=b.getIconTheme(e),i=o.viewClass,a=o.theme;return React.createElement(_icon2.default,{iconClass:t,lugiaConsumers:r.consumer,src:n,singleTheme:!0,viewClass:i,theme:a})},this.getPreIcon=function(e){var t=b.props.icons,n=void 0===t?{}:t;if(!n)return null;var r=n.prefixIconClass,o=n.prefixIconSrc;return r||o?b.getPreOrSuffixIcon("PrefixIcon",r,o,e):null},this.getSuffixIcon=function(e){var t=b.props.icons,n=void 0===t?{}:t;if(!n)return null;var r=n.suffixIconClass,o=n.suffixIconSrc;return r||o?b.getPreOrSuffixIcon("SuffixIcon",r,o,e):null},this.getButton=function(){return b.props.divided?b.getDevidedButton():b.getNoDevidedButton()},this.getText=function(){var e=b.props,t=e.children,n=e.text;return n?n.toString():t},this.getDividedContainerRadius=function(){var e=b.props.getPartOfThemeConfig("Container").normal,t=(e=void 0===e?{}:e).borderRadius;return void 0===t?{}:t},this.createChannel=function(){return b.props.createEventChannel(["active","hover","disabled"])},this.getDevidedButton=function(){var e=b.props,t=b.state,n=e.divided,r=e.type,o=e.getTheme,i=e.disabled,a=e.switchIconClass,s=e.getPartOfThemeProps,c=e.getPartOfThemeConfig,u=t.hasIconChecked,d=t.hasButtonChecked,l=a.iconClass,p=a.iconSrc,h=b.createChannel(),f=b.createChannel(),m=b.props.getPartOfThemeConfig("TextContainer").normal,v=(m=void 0===m?{}:m).width,C=c("Divided"),g=s("TextContainer",{props:{type:r,checked:d,disabled:i,divided:n,borderRadius:b.getDividedContainerRadius()}});return React.createElement(_dropmenubutton.DividedContainer,{themeProps:b.getWrapThemeProps(C),disabled:i,divided:n,type:r},React.createElement(_dropmenubutton.SeparatorBorder,{disabled:i,themeConfig:C,width:v,checked:u||d,type:r}),React.createElement(_dropmenubutton.DividedWrap,null,React.createElement(_dropmenubutton.DevidedTextContainer,Object.assign({disabled:i,type:r,checked:d,themeProps:g},h.provider),b.getPreIcon(h),b.getText(),b.getSuffixIcon(h),React.createElement(_dropmenubutton.CheckInput,{type:"button",disabled:i,onBlur:b.handleButtonBlur,onClick:b.handleLeftButtonClick})),React.createElement(_dropmenubutton.PullContainer,Object.assign({disabled:i,type:r,Theme:o()},f.provider,{themeProps:s("SwitchIconContainer",{props:{type:r,checked:u,disabled:i,divided:n,borderRadius:b.getDividedContainerRadius()}}),checked:u,onClick:b.handleIconClick,onMouseEnter:b.onMouseEnter,onMouseLeave:b.onMouseLeave}),React.createElement(_dropmenubutton.CheckInput,{disabled:i,type:"button",onBlur:b.handleIconBlur}),React.createElement(_icon2.default,Object.assign({iconClass:l,lugiaConsumers:f.consumer,singleTheme:!0},b.props.getPartOfThemeHocProps("SwitchIcon"),{src:p})))))},this.handleClickWrap=function(e){var t=b.props,n=t.onClick;t.disabled||(n&&n(e),b.onTriggerShow(e))},this.handleIconClick=function(e){b.props.disabled||(b.onTriggerShow(e),b.setState({hasIconChecked:!0}))},this.handleLeftButtonClick=function(e){var t=b.props,n=t._onClick;t.disabled||(n&&n(e),b.setState({hasButtonChecked:!0}))},this.handleIconBlur=function(){b.setState({hasIconChecked:!1})},this.handleButtonBlur=function(){b.setState({hasButtonChecked:!1})},this.onMouseEnter=function(e){var t=b.props,n=t.onMouseEnter;t.disabled||n&&n(e)},this.onMouseLeave=function(e){var t=b.props,n=t.onMouseLeave;t.disabled||n&&n(e)},this.getIconTheme=function(e){var t=b.props.getPartOfThemeHocProps(e),n=t.viewClass,r=t.theme;switch(e){case"SwitchIcon":return{viewClass:n,theme:(0,_objectUtils.deepMerge)(_defineProperty({},n,Object.assign({},{normal:{padding:{top:0,left:6,bottom:0,right:6},getCSS:function(){return"\n              transition: all 0.3s\n              "}}})),r)};case"PrefixIcon":return{viewClass:n,theme:(0,_objectUtils.deepMerge)(_defineProperty({},n,Object.assign({},{normal:{padding:{top:0,left:0,bottom:0,right:3},getCSS:function(){return"\n              transition: all 0.3s\n              "}}})),r)};case"SuffixIcon":return{viewClass:n,theme:(0,_objectUtils.deepMerge)(_defineProperty({},n,Object.assign({},{normal:{padding:{top:0,left:3,bottom:0,right:0},getCSS:function(){return"\n              transition: all 0.3s\n              "}}})),r)}}return{viewClass:n,theme:r}}};exports.default=(0,_themeProvider2.default)(DropMenuButton,_index2.default.DropMenuButton);