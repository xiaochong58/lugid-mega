"use strict";var _regenerator=require("babel-runtime/regenerator"),_regenerator2=_interopRequireDefault(_regenerator),_createClass=function(){function n(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(e,t,a){return t&&n(e.prototype,t),a&&n(e,a),e}}(),_react=require("react"),_react2=_interopRequireDefault(_react),_chai=require("chai"),_chai2=_interopRequireDefault(_chai);require("jest-styled-components");var _enzyme=require("enzyme"),_enzyme2=_interopRequireDefault(_enzyme),_enzymeAdapterReact=require("enzyme-adapter-react-16"),_enzymeAdapterReact2=_interopRequireDefault(_enzymeAdapterReact),_reactTestUtils=require("@lugia/react-test-utils"),_reactTestRenderer=require("react-test-renderer"),_reactTestRenderer2=_interopRequireDefault(_reactTestRenderer),_=require("../"),_2=_interopRequireDefault(_),_trigger=require("../../trigger"),_trigger2=_interopRequireDefault(_trigger),_index=require("../../consts/index"),_index2=_interopRequireDefault(_index),_theme=require("../../theme"),_theme2=_interopRequireDefault(_theme);function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _defineProperty(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function _toConsumableArray(e){if(Array.isArray(e)){for(var t=0,a=Array(e.length);t<e.length;t++)a[t]=e[t];return a}return Array.from(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _asyncToGenerator(e){return function(){var i=e.apply(this,arguments);return new Promise(function(r,u){return function t(e,a){try{var n=i[e](a),l=n.value}catch(e){return void u(e)}if(!n.done)return Promise.resolve(l).then(function(e){t("next",e)},function(e){t("throw",e)});r(l)}("next")})}}_enzyme2.default.configure({adapter:new _enzymeAdapterReact2.default});var exp=_chai2.default.expect,data=function(){for(var e=[],t=0;t<200;t++)e.push({value:"key-"+t,label:"txt"+t});return e}();describe("Select",function(){function e(e){var a=e.mutliple;it("多选mutliple: "+a.toString()+" canInput: true",function(){var e=(0,_enzyme.mount)(_react2.default.createElement(_2.default,{data:data,mutliple:a,canSearch:!0,canInput:!0,displayField:"label"}));v(e);var t="shizhenfeng";r(e,t),s(e),a?exp(e.find(_index2.default.InputTagItem).text()).to.be.equal(t):exp(l(e)[0]).to.be.equal(t)})}it("点击弹出面板",function(){var e=(0,_enzyme.mount)(_react2.default.createElement(_2.default,{displayField:"label",data:data}));e.children().at(0).simulate("click"),e.update(),exp(e.find("MenuContainer").length).to.be.equal(1)}),it("单选 设置value",_asyncToGenerator(_regenerator2.default.mark(function e(){var t,a;return _regenerator2.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=["szfeng"],a=(0,_enzyme.mount)(_react2.default.createElement(_2.default,{mutliple:!0,data:data,value:t,displayField:"label"})),exp(l(a)).to.be.eql(t),exp(p(a)).to.be.eql(t);case 4:case"end":return e.stop()}},e,void 0)}))),it("单选查询功能",_asyncToGenerator(_regenerator2.default.mark(function e(){var t;return _regenerator2.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=(0,_enzyme.mount)(_react2.default.createElement(_2.default,{data:data,canSearch:!0,displayField:"label"})),"szfeng",v(t),r(t,"szfeng"),exp(i(t)).to.be.equal("szfeng");case 5:case"end":return e.stop()}},e,void 0)}))),it("关闭trigger后，清空queryInput值",function(){var e=(0,_enzyme.mount)(_react2.default.createElement(_2.default,{data:data,canSearch:!0,displayField:"label"}));v(e),r(e,"szfeng"),v(e),v(e),exp(i(e)).to.be.equal("")}),it("点击选择全部",function(){var e=(0,_enzyme.mount)(_react2.default.createElement(_2.default,{data:data,mutliple:!0,displayField:"label"}));v(e),d(e),exp(c(e).props().isCheckedAll).to.be.true,d(e),exp(c(e).props().isCheckedAll).to.be.false}),e({mutliple:!0}),e({mutliple:!1}),it("选择全部 limitCount: 10",_asyncToGenerator(_regenerator2.default.mark(function e(){var t,a;return _regenerator2.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:v(t=(0,_enzyme.mount)(_react2.default.createElement(_2.default,{data:data,mutliple:!0,limitCount:10,displayField:"label"}))),d(t),exp(c(t).props().isCheckedAll).to.be.true,a=data.filter(function(e,t){return t<10}).map(function(e){return e.value}),f(t,a);case 6:case"end":return e.stop()}},e,void 0)}))),it("选择全部 limitCount: 10, canInput 先选全部再自定义输入",_asyncToGenerator(_regenerator2.default.mark(function e(){var t,a;return _regenerator2.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:v(t=(0,_enzyme.mount)(_react2.default.createElement(_2.default,{data:data,mutliple:!0,canSearch:!0,canInput:!0,limitCount:10,displayField:"label"}))),d(t),r(t,"szfeng"),s(t),exp(c(t).props().isCheckedAll).to.be.true,a=data.filter(function(e,t){return t<10}).map(function(e){return e.value}),f(t,a);case 9:case"end":return e.stop()}},e,void 0)})));var a=(_inherits(u,_react2.default.Component),_createClass(u,[{key:"render",value:function(){var e=this.state,t=this.props,a=e.value,n=e.displayValue,l=t.limitCount;return _react2.default.createElement(_2.default,{data:data,mutliple:!0,value:a,onChange:this.onChange,displayValue:n,canInput:!0,canSearch:!0,limitCount:l,displayField:"label"})}}]),u);function u(e){_classCallCheck(this,u);var n=_possibleConstructorReturn(this,(u.__proto__||Object.getPrototypeOf(u)).call(this,e));n.onChange=function(e){var t=e.newValue,a=e.newDisplayValue;n.setState({value:t,displayValue:a})};var t=e.value,a=void 0===t?[]:t,l=e.displayValue,r=void 0===l?[]:l;return n.state={value:a,displayValue:r},n}function r(e,t){n(e).simulate("change",{target:{value:t}})}function n(e){return e.find(_index2.default.Input).find("input").at(0)}function i(e){return n(e).props().value}function v(e){(function(e){return e.find(_index2.default.InputTagFocuInput)})(e).simulate("click")}function d(e){c(e).simulate("click")}function o(e){e.find("RefreshButton").simulate("click")}function c(e){return e.find("CheckAllButton")}function s(e){!function(e,t){n(e).simulate("keydown",{keyCode:t})}(e,13)}function f(e,t){exp(function(e){return e.find(_index2.default.Menu).props().selectedKeys}(e)).to.be.eql(t),exp(l(e)).to.be.eql(t)}function l(e){return t(e).props().value}function p(e){return t(e).props().displayValue}function t(e){return e.find(_index2.default.InputTag)}function m(e){return e.map(function(e){return e.value})}function _(e){return e.map(function(e){return e.label})}it("limitCount: 5 受限组件",function(){var e=(0,_enzyme.mount)(_react2.default.createElement(a,{limitCount:5}));v(e),d(e),exp(c(e).props().isCheckedAll).to.be.true;var t=data.filter(function(e,t){return t<5}).map(function(e){return e.value});f(e,[].concat(_toConsumableArray(t))),d(e),f(e,[]),exp(c(e).props().isCheckedAll).to.be.false}),it("limitCount: 5 受限组件==>有默认值==>刷新",function(){var e=["key-0"],t=(0,_enzyme.mount)(_react2.default.createElement(a,{value:e,limitCount:5}));v(t),f(t,e),o(t),f(t,[]),exp(i(t)).to.be.equal("")}),it("默认值为顶部的值 然后全选 limitCount: 5",function(){var e=["key-0","key-1"],t=(0,_enzyme.mount)(_react2.default.createElement(_2.default,{data:data,mutliple:!0,defaultValue:e,defaultDisplayValue:[],canSearch:!0,canInput:!0,limitCount:5,displayField:"label"}));v(t),d(t),exp(c(t).props().isCheckedAll).to.be.true,f(t,[].concat(e,["key-2","key-3","key-4"])),v(t),d(t),exp(c(t).props().isCheckedAll).to.be.false,f(t,[])}),it("默认值为中间的值 然后进行全选 limitCount: 5",function(){var e=["key-10","key-11"],t=(0,_enzyme.mount)(_react2.default.createElement(_2.default,{data:data,mutliple:!0,defaultValue:e,defaultDisplayValue:[],canSearch:!0,canInput:!0,limitCount:5,displayField:"label"}));v(t),d(t),exp(c(t).props().isCheckedAll).to.be.true,f(t,[].concat(e,["key-0","key-1","key-2"])),v(t),d(t),exp(c(t).props().isCheckedAll).to.be.false,f(t,[])}),it("默认值为底部的值 然后进行全选 limitCount: 5",function(){var e=["key-199998","key-199999"],t=(0,_enzyme.mount)(_react2.default.createElement(_2.default,{data:data,mutliple:!0,defaultValue:e,defaultDisplayValue:[],canSearch:!0,canInput:!0,limitCount:5,displayField:"label"}));v(t),d(t),exp(c(t).props().isCheckedAll).to.be.true,f(t,[].concat(e,["key-0","key-1","key-2"])),v(t),d(t),exp(c(t).props().isCheckedAll).to.be.false,f(t,[])}),it("受限组件 点击全选",_asyncToGenerator(_regenerator2.default.mark(function e(){var t,a,n,l,r,u,i;return _regenerator2.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=void 0,a=new Promise(function(n){t=function(e){var t=e.newValue,a=e.newDisplayValue;n({value:t,displayValue:a})}}),n=["123"],l=["一二三"],r=_defineProperty({},_index2.default.Select,{width:300}),v(u=(0,_enzyme.mount)(_react2.default.createElement(_theme2.default,{config:r},_react2.default.createElement(_2.default,{data:data,onChange:t,mutliple:!0,value:n,displayValue:l,canSearch:!0,canInput:!0,displayField:"label"})))),d(u),f(u,n),e.next=11,a;case 11:i=e.sent,expect(i).toEqual({value:[].concat(n,_toConsumableArray(m(data))),displayValue:[].concat(l,_toConsumableArray(_(data)))}),f(u,n);case 14:case"end":return e.stop()}},e,void 0)}))),it("受限组件 可自定义输入canInput ,添加",_asyncToGenerator(_regenerator2.default.mark(function e(){var t,a,n,l,r,u,i;return _regenerator2.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=void 0,a=new Promise(function(n){t=function(e){var t=e.newValue,a=e.newDisplayValue;n({value:t,displayValue:a})}}),n=["123"],l=["一二三"],r=_defineProperty({},_index2.default.Select,{width:300}),v(u=(0,_enzyme.mount)(_react2.default.createElement(_theme2.default,{config:r},_react2.default.createElement(_2.default,{data:data,onChange:t,mutliple:!0,value:n,displayValue:l,canSearch:!0,canInput:!0,displayField:"label"})))),d(u),f(u,n),e.next=11,a;case 11:i=e.sent,expect(i).toEqual({value:[].concat(n,_toConsumableArray(m(data))),displayValue:[].concat(l,_toConsumableArray(_(data)))}),f(u,n);case 14:case"end":return e.stop()}},e,void 0)}))),it("非受限组件 value 点击选择全部",_asyncToGenerator(_regenerator2.default.mark(function e(){var t,a,n,l,r,u,i;return _regenerator2.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=void 0,a=new Promise(function(n){t=function(e){var t=e.newValue,a=e.newDisplayValue;n({value:t,displayValue:a})}}),n=["123"],l=["一二三"],r=_defineProperty({},_index2.default.Select,{width:300}),v(u=(0,_enzyme.mount)(_react2.default.createElement(_theme2.default,{config:r},_react2.default.createElement(_2.default,{data:data,onChange:t,mutliple:!0,value:n,displayValue:l,canSearch:!0,canInput:!0,displayField:"label"})))),d(u),f(u,n),e.next=11,a;case 11:i=e.sent,expect(i).toEqual({value:[].concat(n,_toConsumableArray(m(data))),displayValue:[].concat(l,_toConsumableArray(_(data)))}),f(u,n);case 14:case"end":return e.stop()}},e,void 0)}))),it("非受限组件 defaultValue 点击选择全部",_asyncToGenerator(_regenerator2.default.mark(function e(){var t,a,n,l,r,u,i,o,c;return _regenerator2.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=void 0,a=new Promise(function(n){t=function(e){var t=e.newValue,a=e.newDisplayValue;n({value:t,displayValue:a})}}),n=["123"],l=["一二三"],r=_defineProperty({},_index2.default.Select,{width:300}),v(u=(0,_enzyme.mount)(_react2.default.createElement(_theme2.default,{config:r},_react2.default.createElement(_2.default,{data:data,onChange:t,mutliple:!0,defaultValue:n,defaultDisplayValue:l,canSearch:!0,canInput:!0,displayField:"label"})))),d(u),i=[].concat(n,_toConsumableArray(m(data))),o=[].concat(l,_toConsumableArray(_(data))),f(u,i),e.next=13,a;case 13:c=e.sent,expect(c).toEqual({value:i,displayValue:o});case 15:case"end":return e.stop()}},e,void 0)}))),it("canInput，先输入自定义值，再选择全部",_asyncToGenerator(_regenerator2.default.mark(function e(){var t,a,n;return _regenerator2.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=_defineProperty({},_index2.default.Select,{width:300}),v(a=(0,_enzyme.mount)(_react2.default.createElement(_theme2.default,{config:t},_react2.default.createElement(_2.default,{data:data,mutliple:!0,canInput:!0,canSearch:!0,limitCount:5,displayField:"label"})))),r(a,"100"),s(a),exp(c(a).props().isCheckedAll).to.be.false,d(a),exp(c(a).props().isCheckedAll).to.be.true,n=data.filter(function(e,t){return t<4}).map(function(e){return e.value}),f(a,["100"].concat(_toConsumableArray(n)));case 11:case"end":return e.stop()}},e,void 0)}))),it("多选mutliple 点击menu第一个，触发onSelect事件",_asyncToGenerator(_regenerator2.default.mark(function e(){var t,a,n,l,r,u;return _regenerator2.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=void 0,a=new Promise(function(n){var l=[];t=function(e){var t=e.newValue,a=e.newDisplayValue;l.push({value:t,displayValue:a}),2===l.length&&n(l)}}),v(n=(0,_enzyme.mount)(_react2.default.createElement(_2.default,{data:data,displayField:"label",mutliple:!0,canSearch:!0,canInput:!0,limitCount:5,onSelect:t}))),n.find(_index2.default.MenuItem).at(0).simulate("click"),l=["key-0"],r=["txt0"],n.find(_index2.default.MenuItem).at(0).simulate("click"),e.next=10,a;case 10:u=e.sent,expect(u).toEqual([{value:l,displayValue:r},{value:[],displayValue:[]}]);case 12:case"end":return e.stop()}},e,void 0)}))),it("单选 点击menu第一个，触发onSelect事件",_asyncToGenerator(_regenerator2.default.mark(function e(){var t,a,n,l,r,u;return _regenerator2.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=void 0,a=new Promise(function(n){var l=[];t=function(e){var t=e.newValue,a=e.newDisplayValue;l.push({value:t,displayValue:a}),2===l.length&&n(l)}}),v(n=(0,_enzyme.mount)(_react2.default.createElement(_2.default,{data:data,displayField:"label",limitCount:5,onSelect:t}))),n.find(_index2.default.MenuItem).at(0).simulate("click"),l="key-0",r="txt0",v(n),n.find(_index2.default.MenuItem).at(0).simulate("click"),e.next=11,a;case 11:u=e.sent,expect(u).toEqual([{value:l,displayValue:r},{value:l,displayValue:r}]);case 13:case"end":return e.stop()}},e,void 0)}))),it("单选 点击menu第一个后再点击第二个，触发onSelect事件",_asyncToGenerator(_regenerator2.default.mark(function e(){var t,a,n,l,r,u,i,o;return _regenerator2.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=void 0,a=new Promise(function(n){var l=[];t=function(e){var t=e.newValue,a=e.newDisplayValue;l.push({value:t,displayValue:a}),2===l.length&&n(l)}}),v(n=(0,_enzyme.mount)(_react2.default.createElement(_2.default,{data:data,displayField:"label",limitCount:5,onSelect:t}))),n.find(_index2.default.MenuItem).at(0).simulate("click"),l="key-0",r="txt0",v(n),n.find(_index2.default.MenuItem).at(1).simulate("click"),u="key-1",i="txt1",e.next=13,a;case 13:o=e.sent,expect(o).toEqual([{value:l,displayValue:r},{value:u,displayValue:i}]);case 15:case"end":return e.stop()}},e,void 0)}))),it("多选mutliple，点击全选按钮，触发onSelect事件",_asyncToGenerator(_regenerator2.default.mark(function e(){var t,a,n,l,r,u;return _regenerator2.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=void 0,a=new Promise(function(n){var l=[];t=function(e){var t=e.newValue,a=e.newDisplayValue;l.push({value:t,displayValue:a}),2===l.length&&n(l)}}),v(n=(0,_enzyme.mount)(_react2.default.createElement(_2.default,{data:data,displayField:"label",mutliple:!0,canSearch:!0,canInput:!0,limitCount:5,onSelect:t}))),d(n),l=data.filter(function(e,t){return t<5}).map(function(e){return e.value}),r=data.filter(function(e,t){return t<5}).map(function(e){return e.label}),d(n),e.next=10,a;case 10:u=e.sent,expect(u).toEqual([{value:l,displayValue:r},{value:[],displayValue:[]}]);case 12:case"end":return e.stop()}},e,void 0)}))),it("多选mutliple，点击选中项，全选状态为‘不全选’",_asyncToGenerator(_regenerator2.default.mark(function e(){var t,a,n,l,r,u,i;return _regenerator2.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=void 0,a=new Promise(function(n){var l=[];t=function(e){var t=e.newValue,a=e.newDisplayValue;l.push({value:t,displayValue:a}),2===l.length&&n(l)}}),v(n=(0,_enzyme.mount)(_react2.default.createElement(_2.default,{data:data,displayField:"label",mutliple:!0,canSearch:!0,canInput:!0,limitCount:5,onSelect:t}))),d(n),l=data.filter(function(e,t){return t<5}).map(function(e){return e.value}),r=data.filter(function(e,t){return t<5}).map(function(e){return e.label}),n.find(_index2.default.MenuItem).at(0).simulate("click"),u=l.slice(1,5),i=r.slice(1,5),e.next=12,a;case 12:return e.sent,e.t0=expect,e.next=16,a;case 16:return e.t1=e.sent,e.t2=[{value:l,displayValue:r},{value:u,displayValue:i}],(0,e.t0)(e.t1).toEqual(e.t2),n.update(),e.next=22,(0,_reactTestUtils.delay)(100);case 22:exp(c(n).props().isCheckedAll).to.be.false;case 23:case"end":return e.stop()}},e,void 0)}))),it("弹出》输入查询字段》收起》弹出，触发onQuery为空",_asyncToGenerator(_regenerator2.default.mark(function e(){var t,n,a,l;return _regenerator2.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t="szfeng",n=void 0,a=new Promise(function(t){var a=[];n=function(e){a.push(e),2===a.length&&t(a)}}),v(l=(0,_enzyme.mount)(_react2.default.createElement(_2.default,{data:data,value:t,throttle:0,onQuery:n,displayField:"label",canSearch:!0,mutliple:!0}))),r(l,t),exp(i(l)).to.be.equal(t),v(l),v(l),e.t0=exp,e.next=12,a;case 12:e.t1=e.sent,e.t2=[t,""],(0,e.t0)(e.t1).to.be.eql(e.t2);case 15:case"end":return e.stop()}},e,void 0)}))),it("弹出》输入查询字段》点击刷新按钮，触发onQuery为空",_asyncToGenerator(_regenerator2.default.mark(function e(){var t,n,a,l;return _regenerator2.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t="szfeng",n=void 0,a=new Promise(function(t){var a=[];n=function(e){a.push(e),2===a.length&&t(a)}}),v(l=(0,_enzyme.mount)(_react2.default.createElement(_2.default,{data:data,value:t,throttle:0,onQuery:n,canSearch:!0,mutliple:!0}))),r(l,t),exp(i(l)).to.be.equal(t),o(l),e.t0=exp,e.next=11,a;case 11:e.t1=e.sent,e.t2=[t,""],(0,e.t0)(e.t1).to.be.eql(e.t2);case 14:case"end":return e.stop()}},e,void 0)}))),it("mutliple canInput:弹出》输入查询字段》敲回车，触发onQuery为空",_asyncToGenerator(_regenerator2.default.mark(function e(){var t,n,a,l;return _regenerator2.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t="szfeng",n=void 0,a=new Promise(function(t){var a=[];n=function(e){a.push(e),2===a.length&&t(a)}}),v(l=(0,_enzyme.mount)(_react2.default.createElement(_2.default,{data:data,value:t,throttle:0,onQuery:n,canSearch:!0,canInput:!0,mutliple:!0}))),r(l,t),exp(i(l)).to.be.equal(t),s(l),e.t0=exp,e.next=11,a;case 11:e.t1=e.sent,e.t2=[t,""],(0,e.t0)(e.t1).to.be.eql(e.t2);case 14:case"end":return e.stop()}},e,void 0)}))),it('displayValue "szfeng" not exist &  dataItem not exist',_asyncToGenerator(_regenerator2.default.mark(function e(){var t;return _regenerator2.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:"szfeng",t=(0,_enzyme.mount)(_react2.default.createElement(_2.default,{data:data,value:"szfeng",mutliple:!0})),expect(t.children().at(0).instance().displayValue).toEqual(["szfeng"]);case 3:case"end":return e.stop()}},e,void 0)}))),it("value = ['szfeng'] not exist &  dataItem not exist",_asyncToGenerator(_regenerator2.default.mark(function e(){var t,a;return _regenerator2.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=["szfeng"],a=(0,_enzyme.mount)(_react2.default.createElement(_2.default,{data:data,value:t,mutliple:!0})),expect(a.children().at(0).instance().displayValue).toEqual(t);case 3:case"end":return e.stop()}},e,void 0)}))),it("displayValue  [\"szfeng\"]  displayValue = 'displayValue' not exist &  dataItem not exist",_asyncToGenerator(_regenerator2.default.mark(function e(){var t,a,n;return _regenerator2.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=["szfeng"],a="displayValue",n=(0,_enzyme.mount)(_react2.default.createElement(_2.default,{data:data,value:t,displayValue:a,mutliple:!0})),expect(n.children().at(0).instance().displayValue).toEqual([a]);case 4:case"end":return e.stop()}},e,void 0)}))),it("displayValue  [\"szfeng\"]  displayValue = 'displayValue' not exist &  dataItem not exist",_asyncToGenerator(_regenerator2.default.mark(function e(){var t,a,n;return _regenerator2.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=["szfeng"],a="displayValue",n=(0,_enzyme.mount)(_react2.default.createElement(_2.default,{data:data,value:t,displayValue:a,mutliple:!0})),expect(n.children().at(0).instance().displayValue).toEqual([a]);case 4:case"end":return e.stop()}},e,void 0)}))),it("didUpdate ",_asyncToGenerator(_regenerator2.default.mark(function e(){var t,a,n;return _regenerator2.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=["szfeng"],a=["displayValue"],n=(0,_enzyme.mount)(_react2.default.createElement(_2.default,{data:data,value:t,displayValue:a,mutliple:!0})),expect(n.children().at(0).instance().displayValue).toEqual(a);case 4:case"end":return e.stop()}},e,void 0)}))),it("didUpdate ",_asyncToGenerator(_regenerator2.default.mark(function e(){var t,a,n;return _regenerator2.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=["szfeng"],a=["displayValue"],n=(0,_enzyme.mount)(_react2.default.createElement(_2.default,{data:data,value:t,displayValue:a,mutliple:!0})),expect(n.children().at(0).instance().displayValue).toEqual(a);case 4:case"end":return e.stop()}},e,void 0)}))),it("displayValue is undefined ",_asyncToGenerator(_regenerator2.default.mark(function e(){var t,a;return _regenerator2.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=["key-0"],a=(0,_enzyme.mount)(_react2.default.createElement(_2.default,{displayField:"label",data:data,value:t,mutliple:!0})),expect(a.children().at(0).instance().displayValue).toEqual(["txt0"]);case 3:case"end":return e.stop()}},e,void 0)}))),it("displayValue is [] ",_asyncToGenerator(_regenerator2.default.mark(function e(){var t,a;return _regenerator2.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=["key-0"],a=(0,_enzyme.mount)(_react2.default.createElement(_2.default,{displayField:"label",displayValue:[],data:data,value:t,mutliple:!0})),expect(a.children().at(0).instance().displayValue).toEqual(["txt0"]);case 3:case"end":return e.stop()}},e,void 0)}))),it("displayValue is [] for didUpdate not exist to exist",_asyncToGenerator(_regenerator2.default.mark(function e(){var t,a;return _regenerator2.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=["key-0"],a=(0,_enzyme.mount)(_react2.default.createElement(_2.default,{displayField:"label",displayValue:[],data:data,value:t,mutliple:!0})),expect(a.children().at(0).instance().displayValue).toEqual(["txt0"]),a.setProps({displayValue:["hello"]}),expect(a.children().at(0).instance().displayValue).toEqual(["hello"]);case 5:case"end":return e.stop()}},e,void 0)}))),it("displayValue is [] for didUpdate  exist to not exist",_asyncToGenerator(_regenerator2.default.mark(function e(){var t,a;return _regenerator2.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=["key-0"],a=(0,_enzyme.mount)(_react2.default.createElement(_2.default,{displayField:"label",displayValue:["hello"],data:data,value:t,mutliple:!0})),expect(a.children().at(0).instance().displayValue).toEqual(["hello"]),a.setProps({displayValue:[]}),expect(a.children().at(0).instance().displayValue).toEqual(["txt0"]);case 5:case"end":return e.stop()}},e,void 0)}))),it("多选mutliple 非受限组件，测试oldValue,newValue",_asyncToGenerator(_regenerator2.default.mark(function e(){var t,a,n,l,r,u,i,o,c,d,s,f,p,m,_,y;return _regenerator2.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=void 0,a=new Promise(function(u){var i=[];t=function(e){var t=e.newValue,a=e.oldValue,n=e.newItem,l=e.oldItem,r=e.newDisplayValue;i.push({newValue:t,oldValue:a,newItem:n,oldItem:l,newDisplayValue:r}),2===i.length&&u(i)}}),n=["szfeng","史振峰"],l=["hades","哈迪斯"],v(r=(0,_enzyme.mount)(_react2.default.createElement(_2.default,{data:data,displayField:"label",mutliple:!0,canSearch:!0,canInput:!0,limitCount:5,onSelect:t,defaultValue:n,defaultDisplayValue:l}))),r.find(_index2.default.MenuItem).at(0).simulate("click"),u=[].concat(n,["key-0"]),i=[].concat(n),o=[].concat(l,["txt0"]),c=[{value:"szfeng",label:"hades"},{value:"史振峰",label:"哈迪斯"},{value:"key-0",label:"txt0"}],d=[{value:"szfeng",label:"hades"},{value:"史振峰",label:"哈迪斯"}],r.find(_index2.default.MenuItem).at(0).simulate("click"),s=[].concat(n),f=[].concat(n,["key-0"]),p=[].concat(l),m=[{value:"szfeng",label:"hades"},{value:"史振峰",label:"哈迪斯"}],_=[{value:"szfeng",label:"hades"},{value:"史振峰",label:"哈迪斯"},{value:"key-0",label:"txt0"}],e.next=20,a;case 20:y=e.sent,expect(y).toEqual([{newValue:u,oldValue:i,newItem:c,oldItem:d,newDisplayValue:o},{newValue:s,oldValue:f,newItem:m,oldItem:_,newDisplayValue:p}]);case 22:case"end":return e.stop()}},e,void 0)}))),it("多选mutliple 受限组件，测试oldValue,newValue",_asyncToGenerator(_regenerator2.default.mark(function e(){var t,a,n,l,r,u,i,o,c,d,s,f,p,m,_,y;return _regenerator2.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=void 0,a=new Promise(function(u){var i=[];t=function(e){var t=e.newValue,a=e.oldValue,n=e.newItem,l=e.oldItem,r=e.newDisplayValue;i.push({newValue:t,oldValue:a,newItem:n,oldItem:l,newDisplayValue:r}),2===i.length&&u(i)}}),n=["szfeng","史振峰"],l=["hades","哈迪斯"],v(r=(0,_enzyme.mount)(_react2.default.createElement(_2.default,{data:data,displayField:"label",mutliple:!0,canSearch:!0,canInput:!0,limitCount:5,onSelect:t,value:n,displayValue:l}))),r.find(_index2.default.MenuItem).at(0).simulate("click"),u=[].concat(n,["key-0"]),i=[].concat(n),o=[].concat(l,["txt0"]),c=[{value:"szfeng",label:"hades"},{value:"史振峰",label:"哈迪斯"},{value:"key-0",label:"txt0"}],d=[{value:"szfeng",label:"hades"},{value:"史振峰",label:"哈迪斯"}],r.find(_index2.default.MenuItem).at(1).simulate("click"),s=[].concat(n,["key-1"]),f=[].concat(n),p=[].concat(l,["txt1"]),m=[{value:"szfeng",label:"hades"},{value:"史振峰",label:"哈迪斯"},{value:"key-1",label:"txt1"}],_=[{value:"szfeng",label:"hades"},{value:"史振峰",label:"哈迪斯"}],e.next=20,a;case 20:y=e.sent,expect(y).toEqual([{newValue:u,oldValue:i,newItem:c,oldItem:d,newDisplayValue:o},{newValue:s,oldValue:f,newItem:m,oldItem:_,newDisplayValue:p}]);case 22:case"end":return e.stop()}},e,void 0)}))),it("单选 value受限组件，displayValue不受限，测试组件被受限",_asyncToGenerator(_regenerator2.default.mark(function e(){var t;return _regenerator2.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return v(t=(0,_enzyme.mount)(_react2.default.createElement(_2.default,{data:data,displayField:"label",value:["key-0"]}))),t.find(_index2.default.MenuItem).at(1).simulate("click"),e.next=5,(0,_reactTestUtils.delay)(300);case 5:return t.update(),exp(l(t)).to.be.eql(["key-0"]),exp(p(t)).to.be.eql(["txt0"]),v(t),t.find(_index2.default.MenuItem).at(3).simulate("click"),e.next=12,(0,_reactTestUtils.delay)(300);case 12:t.update(),exp(l(t)).to.be.eql(["key-0"]),exp(p(t)).to.be.eql(["txt0"]);case 15:case"end":return e.stop()}},e,void 0)}))),it("多选 value受限组件，displayValue不受限，测试组件被受限",_asyncToGenerator(_regenerator2.default.mark(function e(){var t;return _regenerator2.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return v(t=(0,_enzyme.mount)(_react2.default.createElement(_2.default,{data:data,displayField:"label",value:["key-0","key-1"],mutliple:!0}))),t.find(_index2.default.MenuItem).at(2).simulate("click"),e.next=5,(0,_reactTestUtils.delay)(300);case 5:return t.update(),exp(l(t)).to.be.eql(["key-0","key-1"]),exp(p(t)).to.be.eql(["txt0","txt1"]),v(t),t.find(_index2.default.MenuItem).at(1).simulate("click"),e.next=12,(0,_reactTestUtils.delay)(300);case 12:t.update(),exp(l(t)).to.be.eql(["key-0","key-1"]),exp(p(t)).to.be.eql(["txt0","txt1"]);case 15:case"end":return e.stop()}},e,void 0)})))});