"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function r(e,t){for(var o=0;o<t.length;o++){var r=t[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,o){return t&&r(e.prototype,t),o&&r(e,o),e}}(),_templateObject=_taggedTemplateLiteral(["\n    position: relative;\n  "],["\n    position: relative;\n  "]),_templateObject2=_taggedTemplateLiteral(["\n    border-radius: ",";\n    position: relative;\n    box-sizing: border-box;\n  "],["\n    border-radius: ",";\n    position: relative;\n    box-sizing: border-box;\n  "]),_templateObject3=_taggedTemplateLiteral(["\n    border-color: transparent;\n    position: absolute;\n    border-style: solid;\n    line-height: 1;\n  "],["\n    border-color: transparent;\n    position: absolute;\n    border-style: solid;\n    line-height: 1;\n  "]),_templateObject4=_taggedTemplateLiteral(["\n    position: absolute;\n    border-style: solid;\n    border-width: ",";\n    border-top-left-radius: ",";\n  "],["\n    position: absolute;\n    border-style: solid;\n    border-width: ",";\n    border-top-left-radius: ",";\n  "]),_templateObject5=_taggedTemplateLiteral(["\n    z-index: -1;\n  "],["\n    z-index: -1;\n  "]),_templateObject6=_taggedTemplateLiteral(["\n    z-index: 0;\n  "],["\n    z-index: 0;\n  "]),_templateObject7=_taggedTemplateLiteral(["\n    box-sizing: border-box;\n    user-select: none;\n    overflow: hidden;\n    text-align: left;\n    text-decoration: none;\n  "],["\n    box-sizing: border-box;\n    user-select: none;\n    overflow: hidden;\n    text-align: left;\n    text-decoration: none;\n  "]),_templateObject8=_taggedTemplateLiteral(["\n    box-sizing: border-box;\n    user-select: none;\n    overflow: hidden;\n    text-align: left;\n    text-decoration: none;\n    line-height: 1.5;\n  "],["\n    box-sizing: border-box;\n    user-select: none;\n    overflow: hidden;\n    text-align: left;\n    text-decoration: none;\n    line-height: 1.5;\n  "]),_templateObject9=_taggedTemplateLiteral(["\n    display: inline-block;\n  "],["\n    display: inline-block;\n  "]);exports.hasVisibleInProps=hasVisibleInProps,exports.processOnVisibleChange=processOnVisibleChange,exports.getStateFromProps=getStateFromProps;var _react=require("react"),React=_interopRequireWildcard(_react),_trigger2=require("../trigger"),_trigger3=_interopRequireDefault(_trigger2),_index=require("../consts/index"),_index2=_interopRequireDefault(_index),_tooltip=require("../css/tooltip"),_themeHoc=require("@lugia/theme-hoc"),_themeHoc2=_interopRequireDefault(_themeHoc),_themeCssHoc=require("@lugia/theme-css-hoc"),_themeCssHoc2=_interopRequireDefault(_themeCssHoc),_themeUtils=require("@lugia/theme-utils"),_themeCommonDict=require("../css/theme-common-dict"),_themeCommonDict2=_interopRequireDefault(_themeCommonDict),_css=require("@lugia/css");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _interopRequireWildcard(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _taggedTemplateLiteral(e,t){return Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var px2remcss=_css.units.px2remcss,defaultColor="$lugia-dict.@lugia/lugia-web.defaultColor",blackColor="$lugia-dict.@lugia/lugia-web.blackColor",darkGreyColor="$lugia-dict.@lugia/lugia-web.darkGreyColor",ContentWrapper=(0,_themeCssHoc2.default)({tag:"div",className:"TooltipContentWrapper",normal:{selectNames:[["margin"],["opacity"]],defaultTheme:{},getCSS:function(e,t){var o=t.propsConfig.direction;return"padding:"+px2remcss(1)+";padding-"+o+":"+px2remcss(10)+";background: transparent;box-shadow:none;"}},css:(0,_themeCssHoc.css)(_templateObject)}),Content=(0,_themeCssHoc2.default)({tag:"div",className:"TooltipContent",normal:{selectNames:[["background"],["padding"],["width"],["height"],["boxShadow"],["borderRadius"],["border"],["opacity"]],defaultTheme:{background:{color:defaultColor},boxShadow:(0,_themeUtils.getBoxShadow)("0 0 6 rgba(51, 51, 51, 0.2)"),padding:{top:6,bottom:6,left:8,right:8}}},css:(0,_themeCssHoc.css)(_templateObject2,px2remcss(5))}),Arrow=(0,_themeCssHoc2.default)({tag:"div",className:"ToolTipArrow",normal:{selectNames:[],getCSS:function(e,t){var o=t.propsConfig,r=e.background,i=void 0===r?{}:r,s=o.direction,n=void 0===s?_tooltip.Up:s,a=i&&i.color?i.color:(0,_themeCommonDict2.default)("defaultColor");switch(n){case _tooltip.Up:return"\n        left: "+px2remcss(10)+";\n        top: "+px2remcss(-5)+";\n        border-width: 0 "+px2remcss(5)+" "+px2remcss(5)+";\n        border-bottom-color: "+a+";\n      ";case _tooltip.Down:return"\n        left: "+px2remcss(10)+";\n        bottom: "+px2remcss(-3)+";\n        border-width: "+px2remcss(5)+" "+px2remcss(5)+" 0;\n        border-top-color: "+a+";\n      ";case _tooltip.Left:return"\n        top: "+px2remcss(10)+";\n        left: "+px2remcss(-5)+";\n        border-width: "+px2remcss(5)+" "+px2remcss(5)+" "+px2remcss(5)+" 0;\n        border-right-color: "+a+";\n      ";case _tooltip.Right:return"\n        top: "+px2remcss(10)+";\n        right: "+px2remcss(-5)+";\n        border-width: "+px2remcss(5)+" 0 "+px2remcss(5)+" "+px2remcss(5)+";\n        border-left-color: "+a+";\n      ";default:return"background:transparent"}}},css:(0,_themeCssHoc.css)(_templateObject3)}),BaseArrow=(0,_themeCssHoc2.default)({tag:"div",className:"ToolTipBaseArrow",normal:{selectNames:[["background"],["opacity"]],defaultTheme:{},getCSS:function(e,t){var o=t.propsConfig,r=e.background,i=void 0===r?{}:r,s=i&&i.color?i.color:(0,_themeCommonDict2.default)("defaultColor"),n=o.direction,a=void 0===n?_tooltip.Up:n,l=o.placement,c="";switch(a){case _tooltip.Up:c="45deg";break;case _tooltip.Down:c="225deg";break;case _tooltip.Left:c="315deg";break;case _tooltip.Right:c="135deg"}var p="top: "+px2remcss(-4)+";",m="bottom: "+px2remcss(-4)+";",d="right: "+px2remcss(-4)+";",u="left: "+px2remcss(-4)+";",b="";switch(l){case"bottomLeft":b="left: "+px2remcss(10)+";"+p+"; ";break;case"bottom":b="left: 46%;"+p+"; ";break;case"bottomRight":b="right: "+px2remcss(10)+";"+p+"; ";break;case"topLeft":b="left: "+px2remcss(10)+";"+m+";";break;case"top":b="left: 46%;"+m+";";break;case"topRight":b="right: "+px2remcss(10)+";"+m+"; ";break;case"rightTop":b="top: "+px2remcss(10)+";"+u+"; ";break;case"right":b="top: 46%;"+u+";";break;case"rightBottom":b="bottom: "+px2remcss(10)+"; "+u+";";break;case"leftTop":b="top: "+px2remcss(10)+";"+d+";";break;case"left":b=" top: 46%;"+d+";";break;case"leftBottom":b=" bottom: "+px2remcss(10)+"; "+d+";";break;default:b=""}return"border-color: "+s+" transparent transparent "+s+";transform: rotateZ("+c+"); "+b+";"}},css:(0,_themeCssHoc.css)(_templateObject4,px2remcss(4),px2remcss(4))}),NewArrow=(0,_themeCssHoc2.default)({extend:BaseArrow,className:"ToolNewArrow",normal:{selectNames:[["background"],["opacity"],["boxShadow"]],defaultTheme:{boxShadow:(0,_themeUtils.getBoxShadow)("0 0 6 rgba(0, 0, 0, 0.15)")}},css:(0,_themeCssHoc.css)(_templateObject5)}),MaskArrow=(0,_themeCssHoc2.default)({extend:BaseArrow,className:"ToolMaskArrow",normal:{selectNames:[["background"],["opacity"]],defaultTheme:{}},css:(0,_themeCssHoc.css)(_templateObject6)}),Title=(0,_themeCssHoc2.default)({tag:"div",className:"TooltipTitle",normal:{selectNames:[["opacity"],["background"],["width"],["height"],["color"],["font"],["fontSize"],["margin"]],defaultTheme:{color:blackColor,fontSize:12},getCSS:function(e,t){if(t.propsConfig.description)return"margin-bottom:"+px2remcss(10)}},css:(0,_themeCssHoc.css)(_templateObject7)}),Description=(0,_themeCssHoc2.default)({tag:"div",className:"TooltipDescription",normal:{selectNames:[["opacity"],["background"],["width"],["height"],["color"],["font"],["fontSize"],["margin"]],defaultTheme:{color:darkGreyColor,fontSize:12}},css:(0,_themeCssHoc.css)(_templateObject8)}),ChildrenContainer=(0,_themeCssHoc2.default)({tag:"div",className:"ChildrenContainer",normal:{selectNames:[["width"]]},css:(0,_themeCssHoc.css)(_templateObject9)});function hasVisibleInProps(e){return"visible"in e}function processOnVisibleChange(e){var t=this.props.onVisibleChange,o=hasVisibleInProps(this.props),r=o?this.props.visible:e;o||this.setState({visible:r}),t&&t(e)}function getStateFromProps(e,t){var o=hasVisibleInProps(e),r="defaultVisible"in e;return t?o?{visible:!!e.visible}:{visible:t.visible}:{visible:!!(o?e.visible:r&&e.defaultVisible)}}var Tooltip=function(){function n(){var e,t,o;_classCallCheck(this,n);for(var r=arguments.length,i=Array(r),s=0;s<r;s++)i[s]=arguments[s];return(t=o=_possibleConstructorReturn(this,(e=n.__proto__||Object.getPrototypeOf(n)).call.apply(e,[this].concat(i)))).getDirection=function(e){if(e)return e.startsWith(_tooltip.Left)?_tooltip.Right:e.startsWith(_tooltip.Right)?_tooltip.Left:e.startsWith(_tooltip.Down)?_tooltip.Up:e.startsWith(_tooltip.Up)?_tooltip.Down:void 0},o.onVisibleChange=function(e){processOnVisibleChange.call(o,e)},_possibleConstructorReturn(o,t)}return _inherits(n,React.Component),_createClass(n,[{key:"render",value:function(){var t=this,e=this.props,o=e.placement,r=e.action,i=e.popArrowType,s=e.children,n=void 0===s?React.createElement("div",null):s,a=e.size,l=e.getPartOfThemeProps,c=this.state.visible,p=this.getDirection(o),m=l("Container",{props:{size:a,popArrowType:i,direction:p}}),d=l("ChildrenContainer");return React.createElement(_trigger3.default,{themePass:!0,createPortal:!0,popupVisible:c,align:o,ref:function(e){return t.trigger=e},onPopupVisibleChange:this.onVisibleChange,action:r,direction:p,popup:React.createElement(ContentWrapper,{themeProps:m},this.getContent(m,p))},React.createElement(ChildrenContainer,{themeProps:d},n))}},{key:"setPopupVisible",value:function(){var e;this.trigger&&(e=this.trigger).setPopupVisible.apply(e,arguments)}},{key:"getContent",value:function(e,t){var o=this.props,r=o.placement,i=o.popArrowType,s=o.content;return React.createElement(Content,{themeProps:e,popArrowType:i,placement:r},this.getArrow(t),this.getTitle(),this.getDescription(),s)}},{key:"getArrow",value:function(e){var t=this.props,o=t.placement,r=t.popArrowType,i=this.props.getPartOfThemeProps("Container",{props:{direction:e,placement:o}});return"round"===r?[React.createElement(NewArrow,{themeProps:i}),React.createElement(MaskArrow,{themeProps:i})]:React.createElement(Arrow,{themeProps:i})}},{key:"getTitle",value:function(){var e=this.props,t=e.title,o=e.description,r=this.props.getPartOfThemeProps("TooltipTitle",{props:{description:o}});return t?React.createElement(Title,{themeProps:r},t):null}},{key:"getDescription",value:function(){var e=this.props.description,t=this.props.getPartOfThemeProps("TooltipDescription");return e?React.createElement(Description,{themeProps:t},e):null}}],[{key:"getDerivedStateFromProps",value:function(e,t){var o="visible"in e,r="defaultVisible"in e;return t?o?{visible:e.visible}:{visible:t.visible}:{visible:o?e.visible:r&&e.defaultVisible}}}]),n}();Tooltip.displayName=_index2.default.Tooltip,Tooltip.defaultProps={getTheme:function(){return{}},defaultVisible:!1,action:["click"]},exports.default=(0,_themeHoc2.default)(Tooltip,_index2.default.Tooltip);