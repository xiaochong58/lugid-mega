"use strict";var _regenerator=require("babel-runtime/regenerator"),_regenerator2=_interopRequireDefault(_regenerator),_createClass=function(){function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),e}}(),_react=require("react"),React=_interopRequireWildcard(_react),_chai=require("chai"),_chai2=_interopRequireDefault(_chai),_themeProvider=require("../../theme-provider"),_themeProvider2=_interopRequireDefault(_themeProvider),_index=require("../../theme/index"),_index2=_interopRequireDefault(_index),_reactTestRenderer=require("react-test-renderer"),_reactTestRenderer2=_interopRequireDefault(_reactTestRenderer),_enzyme=require("enzyme"),_enzyme2=_interopRequireDefault(_enzyme),_enzymeAdapterReact=require("enzyme-adapter-react-16"),_enzymeAdapterReact2=_interopRequireDefault(_enzymeAdapterReact),_reactTestUtils=require("@lugia/react-test-utils");function _interopRequireWildcard(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _asyncToGenerator(e){return function(){var c=e.apply(this,arguments);return new Promise(function(o,i){return function t(e,r){try{var n=c[e](r),a=n.value}catch(e){return void i(e)}if(!n.done)return Promise.resolve(a).then(function(e){t("next",e)},function(e){t("throw",e)});o(a)}("next")})}}function _defineProperty(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var exp=_chai2.default.expect;_enzyme2.default.configure({adapter:new _enzymeAdapterReact2.default}),describe("ThemeProvider",function(){var s="ligx",f=(0,_themeProvider2.default)((_inherits(r,React.Component),_createClass(r,[{key:"render",value:function(){return React.createElement("div",null,"hello")}}]),r),s);function r(e){_classCallCheck(this,r);var t=_possibleConstructorReturn(this,(r.__proto__||Object.getPrototypeOf(r)).call(this,e));return t.state={theme:e.getTheme()},t}it("ThemeProvider",function(){var e,t,r=(0,_themeProvider2.default)((_inherits(n,React.Component),_createClass(n,[{key:"render",value:function(){return React.createElement("div",null,JSON.stringify(this.props.getTheme()),this.props.children)}}]),t=e=n,e.displayName="ThemeProviderTest",t),s);function n(){return _classCallCheck(this,n),_possibleConstructorReturn(this,(n.__proto__||Object.getPrototypeOf(n)).apply(this,arguments))}var a=_reactTestRenderer2.default.create(React.createElement(_index2.default,{config:{ligx:{value:"正念"}}},React.createElement(r,null,"hello everyone")));expect(a).toMatchSnapshot()}),it("ThemeProvider A B  B级可以拿到A级的配置通过svThemeConfigTree 属性 未存在重叠配置的情况",function(){var e,t,n={kxy:{value:"无我"}},a=_defineProperty({},"ligx",{value:"正念"}),r=(_inherits(o,React.Component),_createClass(o,[{key:"render",value:function(){var t=this;return React.createElement(_index2.default,{config:n},React.createElement(_index2.default,{config:a},React.createElement(f,{ref:function(e){t.lgx=e}},"hello everyone")))}}]),t=e=o,e.displayName="ThemeProviderTest",t);function o(){return _classCallCheck(this,o),_possibleConstructorReturn(this,(o.__proto__||Object.getPrototypeOf(o)).apply(this,arguments))}var i=(0,_reactTestUtils.createTestComponent)(r,function(e){var t=e.lgx.getThemeTarget().props.getTheme(),r=Object.assign({},a.ligx,{svThemeConfigTree:Object.assign({},n,a)});exp(t).to.be.eql(r)});(0,_enzyme.mount)(React.createElement(i,null))}),it("ThemeProvider A B C self 级配置 ",function(){var e,t,n={a:{value:"苦"}},a={b:{value:"集"}},o={c:{value:"灭"}},i=_defineProperty({},"ligx",{value:"道"}),r=(_inherits(c,React.Component),_createClass(c,[{key:"render",value:function(){var t=this;return React.createElement(_index2.default,{config:n},React.createElement(_index2.default,{config:a},React.createElement(_index2.default,{config:o},React.createElement(_index2.default,{config:i},React.createElement(f,{ref:function(e){t.lgx=e}},"hello everyone")))))}}]),t=e=c,e.displayName="ThemeProviderTest",t);function c(){return _classCallCheck(this,c),_possibleConstructorReturn(this,(c.__proto__||Object.getPrototypeOf(c)).apply(this,arguments))}var l=(0,_reactTestUtils.createTestComponent)(r,function(e){var t=e.lgx.getThemeTarget().props.getTheme(),r=Object.assign({},i.ligx,{svThemeConfigTree:Object.assign({},n,a,o,i)});exp(t).to.be.eql(r)});(0,_enzyme.mount)(React.createElement(l,null))}),it("ThemeProvider A B C D 级配置 无自己相关的配置",function(){var e,t,n={a:{value:"苦"}},a={b:{value:"集"}},o={c:{value:"灭"}},i={d:{value:"道"}},r=(_inherits(c,React.Component),_createClass(c,[{key:"render",value:function(){var t=this;return React.createElement(_index2.default,{config:n},React.createElement(_index2.default,{config:a},React.createElement(_index2.default,{config:o},React.createElement(_index2.default,{config:i},React.createElement(f,{ref:function(e){t.lgx=e}},"hello everyone")))))}}]),t=e=c,e.displayName="ThemeProviderTest",t);function c(){return _classCallCheck(this,c),_possibleConstructorReturn(this,(c.__proto__||Object.getPrototypeOf(c)).apply(this,arguments))}var l=(0,_reactTestUtils.createTestComponent)(r,function(e){var t=e.lgx.getThemeTarget().props.getTheme(),r={svThemeConfigTree:Object.assign({},n,a,o,i)};exp(t).to.be.eql(r)});(0,_enzyme.mount)(React.createElement(l,null))}),it("ThemeProvider A A A A 级配置 无自己相关的配置",function(){var e,t,r={a:{value:"苦"}},n={a:{value:"集"}},a={a:{value:"灭"}},o={a:{value:"道"}},i=(_inherits(c,React.Component),_createClass(c,[{key:"render",value:function(){var t=this;return React.createElement(_index2.default,{config:r},React.createElement(_index2.default,{config:n},React.createElement(_index2.default,{config:a},React.createElement(_index2.default,{config:o},React.createElement(f,{ref:function(e){t.lgx=e}},"hello everyone")))))}}]),t=e=c,e.displayName="ThemeProviderTest",t);function c(){return _classCallCheck(this,c),_possibleConstructorReturn(this,(c.__proto__||Object.getPrototypeOf(c)).apply(this,arguments))}var l=(0,_reactTestUtils.createTestComponent)(i,function(e){var t=e.lgx.getThemeTarget().props.getTheme(),r={svThemeConfigTree:o};exp(t).to.be.eql(r)});(0,_enzyme.mount)(React.createElement(l,null))}),it("ThemeProvider A B B A 级配置 无自己相关的配置",function(){var e,t,r={a:{value:"苦"}},n={b:{value:"集"}},a={b:{value:"灭"}},o={a:{value:"道"}},i=(_inherits(c,React.Component),_createClass(c,[{key:"render",value:function(){var t=this;return React.createElement(_index2.default,{config:r},React.createElement(_index2.default,{config:n},React.createElement(_index2.default,{config:a},React.createElement(_index2.default,{config:o},React.createElement(f,{ref:function(e){t.lgx=e}},"hello everyone")))))}}]),t=e=c,e.displayName="ThemeProviderTest",t);function c(){return _classCallCheck(this,c),_possibleConstructorReturn(this,(c.__proto__||Object.getPrototypeOf(c)).apply(this,arguments))}var l=(0,_reactTestUtils.createTestComponent)(i,function(e){var t=e.lgx.getThemeTarget().props.getTheme(),r={svThemeConfigTree:Object.assign({},a,o)};exp(t).to.be.eql(r)});(0,_enzyme.mount)(React.createElement(l,null))}),it("ThemeProvider A C B A 级配置 无自己相关的配置",function(){var e,t,r={a:{value:"苦"}},n={c:{value:"集"}},a={b:{value:"灭"}},o={a:{value:"道"}},i=(_inherits(c,React.Component),_createClass(c,[{key:"render",value:function(){var t=this;return React.createElement(_index2.default,{config:r},React.createElement(_index2.default,{config:n},React.createElement(_index2.default,{config:a},React.createElement(_index2.default,{config:o},React.createElement(f,{ref:function(e){t.lgx=e}},"hello everyone")))))}}]),t=e=c,e.displayName="ThemeProviderTest",t);function c(){return _classCallCheck(this,c),_possibleConstructorReturn(this,(c.__proto__||Object.getPrototypeOf(c)).apply(this,arguments))}var l=(0,_reactTestUtils.createTestComponent)(i,function(e){var t=e.lgx.getThemeTarget().props.getTheme(),r={svThemeConfigTree:Object.assign({},n,a,o)};exp(t).to.be.eql(r)});(0,_enzyme.mount)(React.createElement(l,null))}),it("ThemeProvider A C B A 级配置 无自己相关的配置",function(){var e,t,r={a:{value:"苦"}},n={c:{value:"集"}},a={b:{value:"灭"}},o={a:{value:"道"}},i=(_inherits(c,React.Component),_createClass(c,[{key:"render",value:function(){var t=this;return React.createElement(_index2.default,{config:r},React.createElement(_index2.default,{config:n},React.createElement(_index2.default,{config:a},React.createElement(_index2.default,{config:o},React.createElement(f,{ref:function(e){t.lgx=e}},"hello everyone")))))}}]),t=e=c,e.displayName="ThemeProviderTest",t);function c(){return _classCallCheck(this,c),_possibleConstructorReturn(this,(c.__proto__||Object.getPrototypeOf(c)).apply(this,arguments))}var l=(0,_reactTestUtils.createTestComponent)(i,function(e){var t=e.lgx.getThemeTarget().props.getTheme(),r={svThemeConfigTree:Object.assign({},n,a,o)};exp(t).to.be.eql(r)});(0,_enzyme.mount)(React.createElement(l,null))}),it("ThemeProvider getTheme来自于配置树 B",function(){var e,t,r={a:{value:"苦"}},n=_defineProperty({},s,{value:"集"}),a={b:{value:"灭"}},o={a:{value:"道"}},i=(_inherits(c,React.Component),_createClass(c,[{key:"render",value:function(){var t=this;return React.createElement(_index2.default,{config:r},React.createElement(_index2.default,{config:n},React.createElement(_index2.default,{config:a},React.createElement(_index2.default,{config:o},React.createElement(f,{ref:function(e){t.lgx=e}},"hello everyone")))))}}]),t=e=c,e.displayName="ThemeProviderTest",t);function c(){return _classCallCheck(this,c),_possibleConstructorReturn(this,(c.__proto__||Object.getPrototypeOf(c)).apply(this,arguments))}var l=(0,_reactTestUtils.createTestComponent)(i,function(e){var t=e.lgx.getThemeTarget().props.getTheme(),r=Object.assign({svThemeConfigTree:Object.assign({},n,a,o)},n[s]);exp(t).to.be.eql(r)});(0,_enzyme.mount)(React.createElement(l,null))}),it("ThemeProvider getTheme来自于配置树 C",function(){var e,t,r={a:{value:"苦"}},n={b:{value:"集"}},a=_defineProperty({},s,{value:"灭"}),o={a:{value:"道"}},i=(_inherits(c,React.Component),_createClass(c,[{key:"render",value:function(){var t=this;return React.createElement(_index2.default,{config:r},React.createElement(_index2.default,{config:n},React.createElement(_index2.default,{config:a},React.createElement(_index2.default,{config:o},React.createElement(f,{ref:function(e){t.lgx=e}},"hello everyone")))))}}]),t=e=c,e.displayName="ThemeProviderTest",t);function c(){return _classCallCheck(this,c),_possibleConstructorReturn(this,(c.__proto__||Object.getPrototypeOf(c)).apply(this,arguments))}var l=(0,_reactTestUtils.createTestComponent)(i,function(e){var t=e.lgx.getThemeTarget().props.getTheme(),r=Object.assign({svThemeConfigTree:Object.assign({},n,a,o)},a[s]);exp(t).to.be.eql(r)});(0,_enzyme.mount)(React.createElement(l,null))}),it("ThemeProvider 更新Theme props",_asyncToGenerator(_regenerator2.default.mark(function e(){return _regenerator2.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Promise(function(o){var e,t,i={a:{value:"苦"}},c={b:{value:"集"}},l=_defineProperty({},s,{value:"灭"}),n={a:{value:"道"}},r=(_inherits(a,React.Component),_createClass(a,[{key:"render",value:function(){var t=this,e=this.props,r=e.A,n=e.B,a=e.C,o=e.D;return React.createElement(_index2.default,{config:r},React.createElement(_index2.default,{config:n},React.createElement(_index2.default,{config:a},React.createElement(_index2.default,{config:o},React.createElement(f,{ref:function(e){t.lgx=e}},"hello everyone")))))}}]),t=e=a,e.displayName="ThemeProviderTest",t);function a(){return _classCallCheck(this,a),_possibleConstructorReturn(this,(a.__proto__||Object.getPrototypeOf(a)).apply(this,arguments))}var u=(0,_reactTestUtils.createTestComponent)(r,function(e){var t=e.lgx.getThemeTarget().props.getTheme(),r=Object.assign({svThemeConfigTree:Object.assign({},c,l,n)},l[s]);exp(t).to.be.eql(r)},{componentDidUpdate:function(e,t,r){var n=r.lgx.getThemeTarget().props.getTheme(),a=Object.assign({svThemeConfigTree:Object.assign({},i,c,l)},l[s]);exp(n).to.be.eql(a),o(!0)}});(0,_enzyme.mount)(React.createElement(u,{A:i,B:c,C:l,D:n})).setProps({A:n,B:l,C:c,D:i})});case 2:case"end":return e.stop()}},e,void 0)})))});