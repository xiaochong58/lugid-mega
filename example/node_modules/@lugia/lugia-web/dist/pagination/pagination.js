"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.borderSize=void 0;var _createClass=function(){function a(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(e,t,r){return t&&a(e.prototype,t),r&&a(e,r),e}}(),_templateObject=_taggedTemplateLiteral(["\n    list-style: none;\n    user-select: none;\n  "],["\n    list-style: none;\n    user-select: none;\n  "]),_templateObject2=_taggedTemplateLiteral(["\n    ",";\n  "],["\n    ",";\n  "]),_templateObject3=_taggedTemplateLiteral(["\n    display: flex;\n    align-items: center;\n    justify-content: center;\n  "],["\n    display: flex;\n    align-items: center;\n    justify-content: center;\n  "]),_templateObject4=_taggedTemplateLiteral(["\n    list-style: none;\n    float: left;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n  "],["\n    list-style: none;\n    float: left;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n  "]),_templateObject5=_taggedTemplateLiteral(["\n    text-align: center;\n    list-style: none;\n    float: left;\n  "],["\n    text-align: center;\n    list-style: none;\n    float: left;\n  "]),_templateObject6=_taggedTemplateLiteral(["\n    display: flex;\n    align-items: center;\n  "],["\n    display: flex;\n    align-items: center;\n  "]),_templateObject7=_taggedTemplateLiteral(["\n    margin: auto;\n    ",";\n  "],["\n    margin: auto;\n    ",";\n  "]),_react=require("react"),_react2=_interopRequireDefault(_react),_select=require("../select"),_select2=_interopRequireDefault(_select),_input=require("../input"),_input2=_interopRequireDefault(_input),_icon=require("../icon"),_icon2=_interopRequireDefault(_icon),_themeCssHoc=require("@lugia/theme-css-hoc"),_themeCssHoc2=_interopRequireDefault(_themeCssHoc),_themeProvider=require("../theme-provider"),_themeProvider2=_interopRequireDefault(_themeProvider),_themeUtils=require("@lugia/theme-utils"),_objectUtils=require("@lugia/object-utils"),_stateColor=require("../css/stateColor"),_stateColor2=_interopRequireDefault(_stateColor),_consts=require("../consts"),_consts2=_interopRequireDefault(_consts),_typeUtils=require("@lugia/type-utils"),_Math=require("../common/Math");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _defineProperty(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _taggedTemplateLiteral(e,t){return Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var _colorsFunc=(0,_stateColor2.default)(),borderSize=_colorsFunc.borderSize;exports.borderSize=borderSize;var themeColor="$lugia-dict.@lugia/lugia-web.themeColor",themeHoverColor="$lugia-dict.@lugia/lugia-web.themeHoverColor",borderColor="$lugia-dict.@lugia/lugia-web.borderColor",blackColor="$lugia-dict.@lugia/lugia-web.blackColor",darkGreyColor="$lugia-dict.@lugia/lugia-web.darkGreyColor",lightGreyColor="$lugia-dict.@lugia/lugia-web.lightGreyColor",superLightColor="$lugia-dict.@lugia/lugia-web.superLightColor",borderRadius="$lugia-dict.@lugia/lugia-web.borderRadiusValue",defaultColor="$lugia-dict.@lugia/lugia-web.defaultColor",getOrderCSS=function(e){var t=e.order,r=e.align;return"order: "+(t||("Right"===r?"":5))+";"},PaginationList=(0,_themeCssHoc2.default)({tag:"ul",className:"PaginationList",normal:{selectNames:[["margin"]],getThemeMeta:function(e,t){return{margin:{right:t.propsConfig.isLast?0:16}}}},css:(0,_themeCssHoc.css)(_templateObject)}),BlockUnit=(0,_themeCssHoc.StaticComponent)({tag:"div",className:"PaginationBlockUnit",css:(0,_themeCssHoc.css)(_templateObject2,function(e){return getOrderCSS(e)})}),PaginationTextContainer=(0,_themeCssHoc2.default)({tag:"div",className:"PaginationTextContainer",normal:{selectNames:[["margin"]],getThemeMeta:function(e,t){return{margin:{right:t.propsConfig.isLast?0:16}}}},css:(0,_themeCssHoc.css)(_templateObject3)}),PaginationMoreItem=(0,_themeCssHoc2.default)({tag:"li",className:"PaginationMoreItem",normal:{selectNames:[["width"],["height"],["cursor"],["lineHeight"],["margin"]],defaultTheme:{color:lightGreyColor,width:36,height:36,lineHeight:36,cursor:"pointer",margin:{right:8}},getThemeMeta:function(e,t){return{lineHeight:e.height}}},hover:{selectNames:[["cursor"],["lineHeight"],["margin"]]},css:(0,_themeCssHoc.css)(_templateObject4),option:{hover:!0,active:!0}}),PaginationBaseText=(0,_themeCssHoc2.default)({tag:"span",className:"PaginationBaseText",normal:{selectNames:[["color"],["font"],["fontSize"],["cursor"]],defaultTheme:{color:blackColor,fontSize:14}}}),PaginationTextDivider=(0,_themeCssHoc2.default)({extend:PaginationBaseText,className:"PaginationTextDivider",normal:{selectNames:[["color"],["font"],["fontSize"],["cursor"]],defaultTheme:{margin:{right:5}}}}),PaginationListItem=(0,_themeCssHoc2.default)({extend:PaginationMoreItem,className:"PaginationListItem",normal:{selectNames:[["width"],["height"],["cursor"],["border"],["borderRadius"],["opacity"],["background"],["boxShadow"],["margin"]],getThemeMeta:function(e,t){var r=t.propsConfig.clickable,a=void 0===r||r,o=e.height;return a?{lineHeight:o}:{border:(0,_themeUtils.getBorder)({color:superLightColor,width:borderSize,style:"solid"})}},defaultTheme:{border:(0,_themeUtils.getBorder)({color:borderColor,width:borderSize,style:"solid"}),borderRadius:(0,_themeUtils.getBorderRadius)(borderRadius),cursor:"pointer",background:{color:defaultColor}}},hover:{selectNames:[["cursor"],["border"],["borderRadius"],["opacity"],["background"],["boxShadow"]],defaultTheme:{border:(0,_themeUtils.getBorder)({color:themeHoverColor,width:borderSize,style:"solid"})},getThemeMeta:function(e,t){var r=t.propsConfig.clickable;if(!(void 0===r||r))return{border:(0,_themeUtils.getBorder)({color:superLightColor,width:borderSize,style:"solid"})}}},focus:{selectNames:[["cursor"],["border"],["borderRadius"],["opacity"],["background"],["boxShadow"]],defaultTheme:{border:(0,_themeUtils.getBorder)({color:themeColor,width:borderSize,style:"solid"})},getThemeMeta:function(e,t){return{lineHeight:e.height}}},css:(0,_themeCssHoc.css)(_templateObject5)}),PaginationArrowIconContainer=(0,_themeCssHoc2.default)({extend:PaginationListItem,className:"PaginationArrowIconContainer",normal:{selectNames:[["width"],["height"],["cursor"],["border"],["borderRadius"],["padding"],["margin"],["lineHeight"],["opacity"],["background"],["boxShadow"]],getThemeMeta:function(e,t){var r=t.propsConfig,a=r.isSelected,o=r.type,i=e.height,n="next"===o?0:8,s=void 0;return a&&(s=(0,_themeUtils.getBorder)({color:themeColor,width:borderSize,style:"solid"})),{margin:{right:n},border:s,lineHeight:i}}},hover:{selectNames:[["cursor"],["border"],["borderRadius"],["opacity"],["background"],["boxShadow"]]},disabled:{selectNames:[["cursor"],["border"],["borderRadius"],["opacity"],["background"],["boxShadow"]],defaultTheme:{border:(0,_themeUtils.getBorder)({color:superLightColor,width:borderSize,style:"solid"})}},option:{hover:!0,active:!0}}),PaginationListItemText=(0,_themeCssHoc2.default)({tag:"a",className:"PaginationListItemText",normal:{selectNames:[["fontSize"],["font"],["color"],["cursor"],["opacity"]],defaultTheme:{fontSize:14,color:darkGreyColor}},hover:{selectNames:[["color"],["font"],["fontSize"]],defaultTheme:{color:themeColor}},focus:{selectNames:[["fontSize"],["font"],["color"]],defaultTheme:{color:themeColor}},option:{hover:!0,focus:!0}}),PaginationListContainer=(0,_themeCssHoc2.default)({tag:"div",className:"PaginationListContainer",normal:{selectNames:[["width"],["height"],["background"],["cursor"],["padding"],["opacity"],["margin"]],defaultTheme:{width:"100%"}},css:(0,_themeCssHoc.css)(_templateObject6)}),Blank=(0,_themeCssHoc.StaticComponent)({tag:"div",className:"PaginationBlank",css:(0,_themeCssHoc.css)(_templateObject7,function(e){return getOrderCSS(e)})});function computePage(e,t,r){if(!r||!_typeUtils.ObjectUtils.isNumber(r))return 1;var a=e||t;return Math.floor((r-1)/a)+1}var Pagination=function(){function i(){var e,t,l;_classCallCheck(this,i);for(var r=arguments.length,a=Array(r),o=0;o<r;o++)a[o]=arguments[o];return(t=l=_possibleConstructorReturn(this,(e=i.__proto__||Object.getPrototypeOf(i)).call.apply(e,[this].concat(a)))).enterPage=function(e){e&&e.target&&e.target.value&&l.handleChangePage(Number(e.target.value))},l.quickJumpValueChange=function(e){var t=e.newValue,r=(0,_Math.checkNumber)(t);r!==l.state.quickJumpValue&&l.setState({quickJumpValue:r}),l.handleChangePage(Number(r))},l.onInputBlur=function(e){if(e&&e.target&&e.target.value){var t=l.props.quickJumperInputBlur,r=l.state.pageSize,a=e.target.value;t&&t({current:a,pageSize:r,e:e})}},l.handleChangePage=function(e){var t=l.props,r=t.disabled,a=t.total,o=l.state.pageSize,i=e;if(!r){var n=computePage(o,o,a);n<i&&(i=n),l.setState({current:i})}var s=l.props.onChange;s&&s({current:i,pageSize:o})},l.handleChangePageSize=function(e){var t=l.props.onShowSizeChange,r=l.state,a=r.current,o=r.pageSize,i=e.newValue,n=i.indexOf("条/页"),s=Number(i.substring(0,n));o!==s&&l.setState({pageSize:s}),t&&t(a,s)},l.changePage=function(e){return function(){l.handleChangePage(e)}},l.goPrePage=function(){var e=l.state.current;return Math.max(1,e-5)},l.goNextPage=function(){var e=l.state,t=e.current,r=e.pageSize,a=l.props.total;return Math.min(computePage(0,r,a),t+5)},l.changePageSize=function(t){return function(){var e="pre"===t?l.goPrePage():l.goNextPage();l.changePage(e)()}},l.onMouseLeave=function(){l.setState({showMorePageType:"default"})},l.onMouseEnter=function(e){return function(){l.props.disabled||l.setState({showMorePageType:e})}},l.simpleArrowClick=function(t){return function(){var e=l.checkArrowChange(t);l.changePage(e)()}},l.inputChange=function(e){var t=l.state.current,r=e.newValue,a=(0,_Math.checkNumber)(r);t!==a&&l.handleChangePage(Number(a))},_possibleConstructorReturn(l,t)}return _inherits(i,_react2.default.Component),_createClass(i,[{key:"getPaginationList",value:function(e){var t=this.props.getPartOfThemeProps;return _react2.default.createElement(PaginationList,{themeProps:t("PaginationListContainer",{props:{isLast:e}})},this.getArrow("pre"),this.getPageList(),this.getArrow("next"))}},{key:"getPrePage",value:function(e,t,r){return 2*t<=e-1&&3!==e&&r.unshift(this.getPaginationOmit("pre")),r}},{key:"getNextPage",value:function(e,t,r,a){return 2*r<=e-t&&t!==e-2&&a.push(this.getPaginationOmit("next")),a}},{key:"checkFirstPage",value:function(e,t,r){return 1!==e&&t.unshift(r),t}},{key:"checkLastPage",value:function(e,t,r,a){return e!==t&&a.push(r),a}},{key:"getPageList",value:function(){var e=this.props.total,t=this.state,r=t.current,a=computePage(0,t.pageSize,e),o=[];if(a<=9)for(var i=1;i<=a;i++){var n=r===i;o.push(this.getItems(i,n,i))}else{for(var s=this.getItems(0,!1,1),l=this.getItems(a,!1,a),c=this.getLeftPage(a),u=this.getRightPage(a),g=c;g<=u;g++){var h=r===g;o.push(this.getItems(g,h,g))}o=this.getPrePage(r,2,o),o=this.getNextPage(a,r,2,o),o=this.checkFirstPage(c,o,s),o=this.checkLastPage(u,a,l,o)}return o}},{key:"getRightPage",value:function(e){var t=this.state.current,r=Math.min(t+2,e);return t-1<=2&&(r=5),r}},{key:"getLeftPage",value:function(e){var t=this.state.current,r=Math.max(1,t-2);return e-t<=2&&(r=e-4),r}},{key:"getItems",value:function(e,t,r){var a=this.props,o=a.createEventChannel,i=a.getPartOfThemeProps,n=o(["active","hover"]),s=i("PaginationListItem",{props:{isSelected:t}});return s.themeState.focus=t,_react2.default.createElement(PaginationListItem,Object.assign({},n.provider,{onClick:this.changePage(e),themeProps:s}),_react2.default.createElement(PaginationListItemText,{lugiaConsumers:n.consumer,themeProps:s},r))}},{key:"getPaginationOmit",value:function(e){var t=this.props.createEventChannel(["active","hover"]),r=this.props.getPartOfThemeHocProps("MorePageIcon"),a=r.theme,o=r.viewClass,i=(0,_objectUtils.deepMerge)(_defineProperty({},o,{normal:{color:borderColor,cursor:"pointer",fontSize:12},hover:{color:themeColor,cursor:"pointer"}}),a),n=this.state.showMorePageType,s=void 0===n?"default":n,l="pre"===e,c=l?"向前五页":"向后五页",u="pre"===s&&l?"lugia-icon-direction_double_right":"next"===s&&"next"===e?"lugia-icon-direction_double_left":"lugia-icon-financial_omit";return _react2.default.createElement(PaginationMoreItem,Object.assign({},t.provider,{themeProps:this.props.getPartOfThemeProps("PaginationListItem"),title:c,onClick:this.changePageSize(e),onMouseEnter:this.onMouseEnter(e),onMouseLeave:this.onMouseLeave}),_react2.default.createElement(_icon2.default,{lugiaConsumers:t.consumer,theme:i,viewClass:o,iconClass:u,singleTheme:!0}))}},{key:"getPageSelect",value:function(e){for(var t=(0,this.props.getPartOfThemeHocProps)("PaginationPageSizeSelect"),r=t.theme,a=t.viewClass,o=e?0:16,i=(0,_objectUtils.deepMerge)(_defineProperty({},a,{Menu:{MenuWrap:{normal:{width:90}}},Container:{normal:{width:90,padding:{left:5,right:5},margin:{right:o},color:darkGreyColor,font:{size:14}}}}),r),n=this.props,s=n.pageSizeOptions,l=void 0===s?[10,20,30,50]:s,c=n.defaultPageSize,u=n.pageSize,g=[],h="条/页",p=0;p<l.length;p++)g.push({value:l[p]+h,label:l[p]+h});var m=c+h,d=u&&""!==u?{value:u+h}:{};return _react2.default.createElement(_select2.default,Object.assign({autoHeight:!0,canClear:!1,theme:i,viewClass:a,data:g,displayField:"label",defaultValue:m,onChange:this.handleChangePageSize},d))}},{key:"getQuickJumper",value:function(e){var t=this.props,r=t.getPartOfThemeProps,a=(0,t.getPartOfThemeHocProps)("QuickJumpInput"),o=a.viewClass,i=a.theme,n=(0,_objectUtils.deepMerge)(_defineProperty({},o,{Container:{normal:{width:60,margin:{left:10,right:10}}}}),i),s=r("PaginationQuickJumpText"),l=this.state.quickJumpValue;return _react2.default.createElement(PaginationTextContainer,{themeProps:r("PaginationQuickJumpContainer",{props:{isLast:e}})},_react2.default.createElement(PaginationBaseText,{themeProps:s},"跳至"),_react2.default.createElement(_input2.default,{theme:n,viewClass:o,onEnter:this.enterPage,onBlur:this.onInputBlur,isShowClearButton:!1,value:l,onChange:this.quickJumpValueChange}),_react2.default.createElement(PaginationBaseText,{themeProps:s},"页"))}},{key:"getShowTotalData",value:function(e){var t=this.props,r=t.total,a=t.getPartOfThemeProps;return _react2.default.createElement(PaginationTextContainer,{themeProps:a("PaginationTotalContainer",{props:e})},_react2.default.createElement(PaginationBaseText,{themeProps:a("PaginationTotalText")},"共"+r+"条数据"))}},{key:"showTotal",value:function(){var e=this.props,t=e.showTotal,r=e.total,a=this.state,o=a.current,i=a.pageSize;t&&t(r,[0===r?0:(o-1)*i+1,r<o*i?r:o*i])}},{key:"checkArrowChange",value:function(e){var t=this.props.total,r=this.state,a=r.current,o=r.pageSize,i="pre"===e,n=a;return 1===a&&i||a===t&&"next"===e||(n=i?a-1:a<computePage(0,o,t)?a+1:a),n}},{key:"getArrow",value:function(e){var t=this.props.hideOnSinglePage,r=this.state.current;if(t)return null;var a=this.checkArrowChange(e),o="pre"===e?1<r:r<a;return _react2.default.createElement(PaginationArrowIconContainer,{disabled:!o,themeProps:this.props.getPartOfThemeProps("PaginationArrowIconContainer",{props:{type:e}}),onClick:this.changePage(a)},this.getArrowIcon(e,o))}},{key:"getArrowIcon",value:function(e,t){var r=this.props,a=r.getPartOfThemeHocProps,o=r.preIconClass,i=r.preIconSrc,n=r.nextIconClass,s=r.nextIconSrc;if(r.hideOnSinglePage)return null;var l="pre"===e?o||"lugia-icon-direction_Left":n||"lugia-icon-direction_right",c="pre"===e?i:s,u=a("ChangePageIcon"),g=u.theme,h=u.viewClass,p=t?darkGreyColor:superLightColor,m=t?themeColor:superLightColor,d=t?"pointer":"not-allowed",f=(0,_objectUtils.deepMerge)(_defineProperty({},h,{normal:{color:p,cursor:d,fontSize:12},hover:{color:m,cursor:d}}),g);return _react2.default.createElement(_icon2.default,{disabled:!t,src:c,iconClass:l,theme:f,viewClass:h,onClick:this.simpleArrowClick(e),singleTheme:!0})}},{key:"render",value:function(){if(this.props.simple){var e=this.state,t=e.current,r=computePage(0,e.pageSize,this.props.total),a=this.props.getPartOfThemeHocProps("SimplePaginationInput"),o=a.viewClass,i=a.theme,n=(0,_objectUtils.deepMerge)(_defineProperty({},o,{Container:{normal:{width:50,height:30,margin:{right:10,left:10}}}}),i);return _react2.default.createElement(PaginationListContainer,{themeProps:this.props.getPartOfThemeProps("Container")},this.getArrowIcon("pre",1<t),_react2.default.createElement(_input2.default,{value:t,theme:n,viewClass:o,isShowClearButton:!1,onChange:this.inputChange}),_react2.default.createElement(PaginationTextDivider,{themeProps:this.props.getPartOfThemeProps("PaginationSimpleText")},"/"),_react2.default.createElement(PaginationBaseText,{themeProps:this.props.getPartOfThemeProps("PaginationSimpleText")},r),this.getArrowIcon("next",t<r))}var s={Total:void 0,Page:1,PageInput:void 0,PageSize:void 0},l=["Page"],c=this.props,u=c.blockList,g=void 0===u?l:u,h=c.showQuickJumper,p=c.showTotalData,m=c.isShowTotalData,d=c.showSizeChanger,f=c.align;h&&l.push("PageInput"),(p||m)&&l.push("Total"),d&&l.push("PageSize"),g.forEach(function(e,t){s[e]=t+1});var P=g.length;return _react2.default.createElement(PaginationListContainer,{themeProps:this.props.getPartOfThemeProps("Container")},_react2.default.createElement(BlockUnit,{order:s.Page||1},this.getPaginationList(P===s.Page)),s.PageInput&&_react2.default.createElement(BlockUnit,{order:s.PageInput||2},this.getQuickJumper(P===s.PageInput)),s.Total&&_react2.default.createElement(BlockUnit,{order:s.Total||3},this.getShowTotalData(P===s.Total)),s.PageSize&&_react2.default.createElement(BlockUnit,{order:s.PageSize||4},this.getPageSelect(P===s.PageSize)),_react2.default.createElement(Blank,{align:f}))}}],[{key:"getDerivedStateFromProps",value:function(e,t){var r=t?t.pageSize:0,a=e.pageSize&&""!==e.pageSize?e.pageSize:0,o=e.current,i=t?t.current:e.defaultCurrent,n=t?r:e.defaultPageSize;if("current"in e&&(i=o),"pageSize"in e&&a&&a!==r){var s=computePage(n=a,r,e.total);i=s<i?s:i}return{current:i,pageSize:n}}}]),i}();Pagination.displayName=_consts2.default.Pagination,Pagination.defaultProps={defaultCurrent:1,defaultPageSize:10},exports.default=(0,_themeProvider2.default)(Pagination,_consts2.default.Pagination,{hover:!0,active:!0,focus:!0});