"use strict";var _regenerator=require("babel-runtime/regenerator"),_regenerator2=_interopRequireDefault(_regenerator),_createClass=function(){function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),e}}(),_react=require("react"),_react2=_interopRequireDefault(_react),_=require("../"),_2=_interopRequireDefault(_),_chai=require("chai"),_chai2=_interopRequireDefault(_chai);require("jest-styled-components");var _enzyme=require("enzyme"),_enzyme2=_interopRequireDefault(_enzyme),_enzymeAdapterReact=require("enzyme-adapter-react-16"),_enzymeAdapterReact2=_interopRequireDefault(_enzymeAdapterReact),_theme=require("../../theme"),_theme2=_interopRequireDefault(_theme),_reactTestUtils=require("@lugia/react-test-utils"),_index=require("../../consts/index"),_index2=_interopRequireDefault(_index);function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _asyncToGenerator(e){return function(){var i=e.apply(this,arguments);return new Promise(function(u,o){return function t(e,r){try{var n=i[e](r),a=n.value}catch(e){return void o(e)}if(!n.done)return Promise.resolve(a).then(function(e){t("next",e)},function(e){t("throw",e)});u(a)}("next")})}}function _defineProperty(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var _require=require("@lugia/jverify"),mockFunction=_require.mockFunction,mockObject=_require.mockObject,VerifyOrder=_require.VerifyOrder,VerifyOrderConfig=_require.VerifyOrderConfig;_enzyme2.default.configure({adapter:new _enzymeAdapterReact2.default});var exp=_chai2.default.expect;describe("InputTag",function(){var n,o=(n=_asyncToGenerator(_regenerator2.default.mark(function e(t,r,n){var a,u,o,i=this;return _regenerator2.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=mockObject.create(_._InputTag_.prototype),u=a.mockFunction("getFontWidth"),"function"==typeof r?u.mock(r):u.forever(r),o=(0,_enzyme.mount)(_react2.default.createElement(t,null)),e.next=6,(0,_reactTestUtils.delay)(0,_asyncToGenerator(_regenerator2.default.mark(function e(){return _regenerator2.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return o.update(),e.next=3,n(o);case 3:case"end":return e.stop()}},e,i)})));case 6:a.resetAll();case 7:case"end":return e.stop()}},e,this)})),function(e,t,r){return n.apply(this,arguments)}),u="常,乐,我,净".split(","),i="1,2,3".split(",");function c(e){var t=e.width,r=void 0===t?300:t;return _inherits(n,_react2.default.Component),_createClass(n,[{key:"render",value:function(){var t=this;return _react2.default.createElement(_theme2.default,Object.assign({config:_defineProperty({},_index2.default.InputTag,{InputTagWrap:{normal:{width:r}}})},this.props),_react2.default.createElement(_2.default,Object.assign({},e,{ref:function(e){return t.inputtag=e}})))}}]),n;function n(){return _classCallCheck(this,n),_possibleConstructorReturn(this,(n.__proto__||Object.getPrototypeOf(n)).apply(this,arguments))}}function e(t,r){var n=this;it("只有一个结点 值为字符串 单个值的inputtag"+t+","+r.toString(),_asyncToGenerator(_regenerator2.default.mark(function e(){return _regenerator2.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o(c({displayValue:r,value:t,mutliple:!1}),5,function(e){var t=d(e);exp(e.text().trim()).to.be.equal("string"==typeof r?r:r.join("")),exp(t.length).to.be.equal(1),exp(s(e).length).to.be.equal(1)});case 2:case"end":return e.stop()}},e,n)})))}function t(a,e){var u=this;it("展现值&实际值 宽度够容纳所有的3个结点 "+e,_asyncToGenerator(_regenerator2.default.mark(function e(){return _regenerator2.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o(a,5,function(e){var t=d(e);exp(t.length).to.be.equal(4),exp(t.at(1).text()).to.be.equal("常"),exp(t.at(2).text()).to.be.equal("乐"),exp(t.at(3).text()).to.be.equal("我"),exp(s(e).at(0).getDOMNode()==t.at(0).getDOMNode()).to.be.true,exp(s(e).length).to.be.equal(1)});case 2:case"end":return e.stop()}},e,u)}))),it("展现值&实际值 3个一个结点也容不下"+e,_asyncToGenerator(_regenerator2.default.mark(function e(){return _regenerator2.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o(a,1e3,function(e){var t=d(e);exp(t.length).to.be.equal(2),exp(s(e).length).to.be.equal(1),exp(s(e).at(0).getDOMNode()==t.at(0).getDOMNode()).to.be.true,exp(f(e).length).to.be.equal(1),exp(f(e).at(0).getDOMNode()==t.at(1).getDOMNode()).to.be.true});case 2:case"end":return e.stop()}},e,u)}))),it("展现值&实际值 3个只能容纳一个"+e,_asyncToGenerator(_regenerator2.default.mark(function e(){var t,r,n;return _regenerator2.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=0,r=[5,1e3,1e3],n=function(){return r[t++]},e.next=5,o(a,n,function(e){var t=d(e);exp(t.length).to.be.equal(3),exp(s(e).length).to.be.equal(1),exp(f(e).length).to.be.equal(1),exp(s(e).at(0).getDOMNode()==t.at(0).getDOMNode()).to.be.true,exp(t.at(1).text()).to.be.equal("常"),exp(f(e).at(0).getDOMNode()==t.at(2).getDOMNode()).to.be.true});case 5:case"end":return e.stop()}},e,u)})))}function l(e){e.find(_index2.default.InputTagClearButton).simulate("click")}function s(e){return e.find(_index2.default.InputTagFontItem)}function f(e){return e.find(_index2.default.InputTagMoreItem)}function d(e){return e.find(_index2.default.InputTagItem)}t(c({displayValue:u,value:i}),"[value & displayValue]"),t(c({defaultValue:i,defaultDisplayValue:u}),"[defaultValue & defaultDisplayValue]"),it("只有一个结点 值为字符串",_asyncToGenerator(_regenerator2.default.mark(function e(){return _regenerator2.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o(c({displayValue:"常",value:"1"}),5,function(e){var t=d(e);exp(t.length).to.be.equal(2),exp(t.at(1).text()).to.be.equal("常"),exp(s(e).at(0).getDOMNode()==t.at(0).getDOMNode()).to.be.true,exp(s(e).length).to.be.equal(1)});case 2:case"end":return e.stop()}},e,void 0)}))),e("a","我"),e("a",["我"]),e("a",["我","你","他"]),t(c({value:i,displayValue:u,defaultValue:"hello",defaultDisplayValue:"world"}),"[值与默认值同时存在时，以值为准]"),it("完全显示3个 , 点击第一个的删除图标 onChange事件 非受限组件 default",_asyncToGenerator(_regenerator2.default.mark(function e(){var n,t,r;return _regenerator2.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=void 0,t=new Promise(function(t){n=c({defaultDisplayValue:u,defaultValue:i,onChange:function(e){t(e)}})}),r=new Promise(function(){var t=_asyncToGenerator(_regenerator2.default.mark(function e(r){return _regenerator2.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o(n,1,function(){var t=_asyncToGenerator(_regenerator2.default.mark(function e(t){return _regenerator2.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.find(_index2.default.InputTagCloseButton).at(1).simulate("click"),e.next=3,(0,_reactTestUtils.delay)(0,function(){t.update();var e=d(t);exp(e.length).to.be.equal(3),exp(e.at(1).text()).to.be.equal("乐"),exp(e.at(2).text()).to.be.equal("我"),exp(s(t).at(0).getDOMNode()==e.at(0).getDOMNode()).to.be.true,exp(s(t).length).to.be.equal(1),r(!0)});case 3:case"end":return e.stop()}},e,void 0)}));return function(e){return t.apply(this,arguments)}}());case 2:case"end":return e.stop()}},e,void 0)}));return function(e){return t.apply(this,arguments)}}()),e.next=5,r;case 5:return e.t0=exp,e.next=8,t;case 8:e.t1=e.sent,e.t2={value:"2,3".split(","),displayValue:"乐,我".split(",")},(0,e.t0)(e.t1).to.be.eql(e.t2);case 11:case"end":return e.stop()}},e,void 0)}))),it("完全显示3个 , 点击第一个的删除图标 onChange事件改变值",_asyncToGenerator(_regenerator2.default.mark(function e(){var n,t,r;return _regenerator2.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=void 0,t=new Promise(function(a){function t(e){_classCallCheck(this,t);var n=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.onChange=function(e){var t=e.value,r=e.displayValue;n.setState({value:t,displayValue:r}),a(e)},n.state={value:i,displayValue:u},n}_inherits(t,_react2.default.Component),_createClass(t,[{key:"render",value:function(){var t=this,e=this.state,r=e.value,n=e.displayValue;return _react2.default.createElement(_theme2.default,{config:_defineProperty({},_index2.default.InputTag,{width:300})},_react2.default.createElement(_2.default,{onChange:this.onChange,value:r,displayValue:n,ref:function(e){return t.inputtag=e}}))}}]),n=t}),r=new Promise(function(){var t=_asyncToGenerator(_regenerator2.default.mark(function e(r){return _regenerator2.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o(n,1,function(){var t=_asyncToGenerator(_regenerator2.default.mark(function e(t){return _regenerator2.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.find(_index2.default.InputTagCloseButton).at(1).simulate("click"),e.next=3,(0,_reactTestUtils.delay)(0,_asyncToGenerator(_regenerator2.default.mark(function e(){return _regenerator2.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.update(),e.next=3,(0,_reactTestUtils.delay)(0,function(){t.update();var e=d(t);exp(e.length).to.be.equal(3),exp(e.at(1).text()).to.be.equal("乐"),exp(e.at(2).text()).to.be.equal("我"),exp(s(t).at(0).getDOMNode()==e.at(0).getDOMNode()).to.be.true,exp(s(t).length).to.be.equal(1),r(!0)});case 3:case"end":return e.stop()}},e,void 0)})));case 3:return e.abrupt("return",!0);case 4:case"end":return e.stop()}},e,void 0)}));return function(e){return t.apply(this,arguments)}}());case 2:case"end":return e.stop()}},e,void 0)}));return function(e){return t.apply(this,arguments)}}()),e.next=5,r;case 5:return e.t0=exp,e.next=8,t;case 8:e.t1=e.sent,e.t2={value:"2,3".split(","),displayValue:"乐,我".split(",")},(0,e.t0)(e.t1).to.be.eql(e.t2);case 11:case"end":return e.stop()}},e,void 0)}))),it("完全显示3个 , 点击第一个的删除图标 onChange事件 受限组件 不能改变",_asyncToGenerator(_regenerator2.default.mark(function e(){var n,t,r;return _regenerator2.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=void 0,t=new Promise(function(t){n=c({displayValue:u,value:i,onChange:function(e){t(e)}})}),r=new Promise(function(){var t=_asyncToGenerator(_regenerator2.default.mark(function e(r){return _regenerator2.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o(n,1,function(){var t=_asyncToGenerator(_regenerator2.default.mark(function e(t){return _regenerator2.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.find(_index2.default.InputTagCloseButton).at(1).simulate("click"),e.next=3,(0,_reactTestUtils.delay)(0,function(){t.update();var e=d(t);exp(e.length).to.be.equal(4),exp(e.at(1).text()).to.be.equal("常"),exp(e.at(2).text()).to.be.equal("乐"),exp(e.at(3).text()).to.be.equal("我"),exp(s(t).at(0).getDOMNode()==e.at(0).getDOMNode()).to.be.true,exp(s(t).length).to.be.equal(1),r(!0)});case 3:case"end":return e.stop()}},e,void 0)}));return function(e){return t.apply(this,arguments)}}());case 2:case"end":return e.stop()}},e,void 0)}));return function(e){return t.apply(this,arguments)}}()),e.next=5,r;case 5:return e.t0=exp,e.next=8,t;case 8:e.t1=e.sent,e.t2={value:"2,3".split(","),displayValue:"乐,我".split(",")},(0,e.t0)(e.t1).to.be.eql(e.t2);case 11:case"end":return e.stop()}},e,void 0)}))),it("点击更多按钮 点击删除",_asyncToGenerator(_regenerator2.default.mark(function e(){var r,t,n;return _regenerator2.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=void 0,t=new Promise(function(t){r=c({defaultDisplayValue:u,defaultValue:i,onChange:function(e){t(e)}})}),n=new Promise(function(){var t=_asyncToGenerator(_regenerator2.default.mark(function e(n){return _regenerator2.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o(r,5e3,function(){var t=_asyncToGenerator(_regenerator2.default.mark(function e(r){var t;return _regenerator2.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=d(r),exp(t.length).to.be.equal(2),f(r).simulate("click"),e.next=6,(0,_reactTestUtils.delay)(0,_asyncToGenerator(_regenerator2.default.mark(function e(){return _regenerator2.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r.update(),exp(r.find(_index2.default.DropMenu).length).to.be.equal(1),exp(r.find(_index2.default.MenuItem).length).to.be.equal(3),exp(r.find(_index2.default.Icon).length).to.be.equal(5),r.find(_index2.default.Icon).at(2).simulate("click"),e.next=7,(0,_reactTestUtils.delay)(0,_asyncToGenerator(_regenerator2.default.mark(function e(){return _regenerator2.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r.update(),e.next=3,(0,_reactTestUtils.delay)(0,_asyncToGenerator(_regenerator2.default.mark(function e(){var t;return _regenerator2.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:r.update(),t=r.find(_index2.default.MenuItem),exp(t.length).to.be.equal(2),exp(t.at(0).text().trim()).to.be.equal("乐"),exp(t.at(1).text().trim()).to.be.equal("我"),n(!0);case 6:case"end":return e.stop()}},e,void 0)})));case 3:case"end":return e.stop()}},e,void 0)})));case 7:case"end":return e.stop()}},e,void 0)})));case 6:case"end":return e.stop()}},e,void 0)}));return function(e){return t.apply(this,arguments)}}());case 2:case"end":return e.stop()}},e,void 0)}));return function(e){return t.apply(this,arguments)}}()),e.next=5,n;case 5:return e.t0=exp,e.next=8,t;case 8:e.t1=e.sent,e.t2={value:"2,3".split(","),displayValue:"乐,我".split(",")},(0,e.t0)(e.t1).to.be.eql(e.t2);case 11:case"end":return e.stop()}},e,void 0)}))),it("点击更多按钮 进行查询",_asyncToGenerator(_regenerator2.default.mark(function e(){var r,t;return _regenerator2.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=c({defaultDisplayValue:u,defaultValue:i,width:300}),t=new Promise(function(){var t=_asyncToGenerator(_regenerator2.default.mark(function e(n){return _regenerator2.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o(r,150,function(){var t=_asyncToGenerator(_regenerator2.default.mark(function e(t){var r;return _regenerator2.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return exp(t.find(_index2.default.InputTagMoreItem).length).to.be.equal(1),exp(t.find(_index2.default.ItemTagOption).length).to.be.equal(1),(r=f(t)).simulate("click"),e.next=6,(0,_reactTestUtils.delay)(0,_asyncToGenerator(_regenerator2.default.mark(function e(){return _regenerator2.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t.update(),t.find(_index2.default.Input).find("input").simulate("change",{target:{value:"我"}}),exp(t.find(_index2.default.MenuItem).length).to.be.equal(1),exp(t.find(_index2.default.MenuItem).text().trim()).to.be.equal("我"),t.find(_index2.default.ItemTagOption).at(0).simulate("click"),r.simulate("click"),exp(t.find(_index2.default.Input).props().value).to.be.equal(""),n(!0);case 8:case"end":return e.stop()}},e,void 0)})));case 6:case"end":return e.stop()}},e,void 0)}));return function(e){return t.apply(this,arguments)}}());case 2:case"end":return e.stop()}},e,void 0)}));return function(e){return t.apply(this,arguments)}}()),e.next=4,t;case 4:case"end":return e.stop()}},e,void 0)}))),it("点击清除值 则清除所有值",_asyncToGenerator(_regenerator2.default.mark(function e(){var n,a,t;return _regenerator2.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=void 0,a=new Promise(function(t){n=c({defaultDisplayValue:u,defaultValue:i,width:300,onChange:function(e){t(e)}})}),t=new Promise(function(){var t=_asyncToGenerator(_regenerator2.default.mark(function e(r){return _regenerator2.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o(n,150,function(){var t=_asyncToGenerator(_regenerator2.default.mark(function e(t){return _regenerator2.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return exp(t.find(_index2.default.InputTagMoreItem).length).to.be.equal(1),exp(t.find(_index2.default.ItemTagOption).length).to.be.equal(1),l(t),e.next=5,(0,_reactTestUtils.delay)(0,_asyncToGenerator(_regenerator2.default.mark(function e(){return _regenerator2.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return exp(t.find(_index2.default.InputTagMoreItem).length).to.be.equal(0),exp(t.find(_index2.default.ItemTagOption).length).to.be.equal(0),e.t0=exp,e.next=5,a;case 5:e.t1=e.sent,e.t2={value:[],displayValue:[]},(0,e.t0)(e.t1).to.be.eql(e.t2),r(!0);case 9:case"end":return e.stop()}},e,void 0)})));case 5:case"end":return e.stop()}},e,void 0)}));return function(e){return t.apply(this,arguments)}}());case 2:case"end":return e.stop()}},e,void 0)}));return function(e){return t.apply(this,arguments)}}()),e.next=5,t;case 5:case"end":return e.stop()}},e,void 0)}))),it("受限 点击清除值 则清除所有值",_asyncToGenerator(_regenerator2.default.mark(function e(){var n,a,t;return _regenerator2.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=void 0,a=new Promise(function(t){n=c({displayValue:u,value:i,width:300,onChange:function(e){t(e)}})}),t=new Promise(function(){var t=_asyncToGenerator(_regenerator2.default.mark(function e(r){return _regenerator2.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o(n,150,function(){var t=_asyncToGenerator(_regenerator2.default.mark(function e(t){return _regenerator2.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return exp(t.find(_index2.default.InputTagMoreItem).length).to.be.equal(1),exp(t.find(_index2.default.ItemTagOption).length).to.be.equal(1),l(t),e.next=5,(0,_reactTestUtils.delay)(0,_asyncToGenerator(_regenerator2.default.mark(function e(){return _regenerator2.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return exp(t.find(_index2.default.InputTagMoreItem).length).to.be.equal(1),exp(t.find(_index2.default.ItemTagOption).length).to.be.equal(1),e.t0=exp,e.next=5,a;case 5:e.t1=e.sent,e.t2={value:[],displayValue:[]},(0,e.t0)(e.t1).to.be.eql(e.t2),r(!0);case 9:case"end":return e.stop()}},e,void 0)})));case 5:case"end":return e.stop()}},e,void 0)}));return function(e){return t.apply(this,arguments)}}());case 2:case"end":return e.stop()}},e,void 0)}));return function(e){return t.apply(this,arguments)}}()),e.next=5,t;case 5:case"end":return e.stop()}},e,void 0)})))});