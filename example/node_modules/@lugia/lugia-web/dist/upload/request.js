"use strict";function getRequestXHR(){return window.XMLHttpRequest?new XMLHttpRequest:new window.ActiveXobject("Microsoft.XMLHTTP")}function getFormData(e,t){var r=new FormData;if(e)for(var a in e)r.append(a,e[a]);return t&&r.append("file",t),r}function getQueryString(e){if(!e)return"";var t=[];for(var r in e)t.push(r+"="+e[r]);return t.join("&")}function addEventListener(e,t,r){var a=3<arguments.length&&void 0!==arguments[3]&&arguments[3];e.addEventListener(t,r,a)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.getRequestXHR=getRequestXHR,exports.getFormData=getFormData,exports.getQueryString=getQueryString,exports.addEventListener=addEventListener;var doGet=function(e,t,r,a){var s=getQueryString(r);e.open("get",t+(s?"?"+s:s),a),e.send()},doPost=function(t,e,r,a){var s=r.data,n=r.headers,o=getFormData(s,r.file);t.open("post",e,a),n&&Object.keys(n).forEach(function(e){t.setRequestHeader(e,n[e])}),t.send(o)};function parseResponse(e,t){var r=t.toLocaleLowerCase(),a=e.responseText,s=e.responseXML,n=void 0;switch(r){case"text":n=a;break;case"xml":n=s;break;case"json":n=JSON.parse(a)}return n}function request(e){var t=e.url;if(t){var r=getRequestXHR(),a=e.withCredentials,s=void 0!==a&&a;r.withCredentials=s;var n=e.onProgress,o=e.onComplete;(r.upload.onprogress=n)&&addEventListener(r.upload,"progress",n,!1),o&&addEventListener(r,"load",o,!1);var i=e.method,d=void 0===i?"get":i,u=e.asynch,p=void 0===u||u,v=e.data;switch(d.toLocaleLowerCase()){case"get":doGet(r,t,v,p);break;case"post":default:var c=e.headers,f=e.file;doPost(r,t,{data:v,file:f,headers:c},p)}var g=e.onFail,l=e.dataType,L=void 0===l?"text":l,h=e.onSuccess;return r.onreadystatechange=function(){if(4===r.readyState)if(200===r.status){var e=parseResponse(r,L);h&&h(e)}else{var t=r.responseText;g&&g(t)}},r}}exports.default=request;