"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function o(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(e,t,r){return t&&o(e.prototype,t),r&&o(e,r),e}}(),_templateObject=_taggedTemplateLiteral(["\n        width: ",";\n        resize: ",";\n        &::placeholder {\n          color: ",";\n          font-size: ",";\n          font-weight: ",";\n        }\n      "],["\n        width: ",";\n        resize: ",";\n        &::placeholder {\n          color: ",";\n          font-size: ",";\n          font-weight: ",";\n        }\n      "]),_templateObject2=_taggedTemplateLiteral(["\n    box-sizing: border-box;\n    line-height: 1;\n    font-family: inherit;\n    transition: all ",";\n    outline: none;\n  "],["\n    box-sizing: border-box;\n    line-height: 1;\n    font-family: inherit;\n    transition: all ",";\n    outline: none;\n  "]),_templateObject3=_taggedTemplateLiteral(["\n    position: relative;\n    outline: none;\n    display: inline-block;\n    font-size: 0;\n  "],["\n    position: relative;\n    outline: none;\n    display: inline-block;\n    font-size: 0;\n  "]);require("../common/shirm");var _KeyBoardEventAdaptor=require("../common/KeyBoardEventAdaptor"),_KeyBoardEventAdaptor2=_interopRequireDefault(_KeyBoardEventAdaptor),_react=require("react"),_react2=_interopRequireDefault(_react),_index=require("../consts/index"),_index2=_interopRequireDefault(_index),_themeHoc=require("@lugia/theme-hoc"),_themeHoc2=_interopRequireDefault(_themeHoc),_utils=require("../utils"),_icon=require("../icon"),_icon2=_interopRequireDefault(_icon),_themeCssHoc=require("@lugia/theme-css-hoc"),_themeCssHoc2=_interopRequireDefault(_themeCssHoc),_stateColor=require("../css/stateColor"),_stateColor2=_interopRequireDefault(_stateColor),_css=require("@lugia/css"),_objectUtils=require("@lugia/object-utils"),_themeUtils=require("@lugia/theme-utils"),_typeUtils=require("@lugia/type-utils"),_validateHoc=require("../css/validateHoc"),_validateHoc2=require("./validateHoc"),_validateHoc3=_interopRequireDefault(_validateHoc2);function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _defineProperty(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _taggedTemplateLiteral(e,t){return Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var px2remcss=_css.units.px2remcss,_colorsFunc=(0,_stateColor2.default)(),padding=_colorsFunc.padding,shadowSpread=_colorsFunc.shadowSpread,hShadow=_colorsFunc.hShadow,vShadow=_colorsFunc.vShadow,transitionTime=_colorsFunc.transitionTime,borderSize=_colorsFunc.borderSize,themeHoverColor="$lugia-dict.@lugia/lugia-web.themeHoverColor",themeActiveColor="$lugia-dict.@lugia/lugia-web.themeActiveColor",disableColor="$lugia-dict.@lugia/lugia-web.disableColor",borderColor="$lugia-dict.@lugia/lugia-web.borderColor",blackColor="$lugia-dict.@lugia/lugia-web.blackColor",mediumGreyColor="$lugia-dict.@lugia/lugia-web.mediumGreyColor",darkGreyColor="$lugia-dict.@lugia/lugia-web.darkGreyColor",lightGreyColor="$lugia-dict.@lugia/lugia-web.lightGreyColor",borderRadius="$lugia-dict.@lugia/lugia-web.borderRadiusValue",checkIsPercent=function(e){return e&&"string"==typeof e&&-1!==e.indexOf("%")},Textarea=(0,_themeCssHoc2.default)({tag:"textarea",className:"Textarea",normal:{selectNames:[["height"],["fontSize"],["font"],["color"],["background"],["border"],["borderRadius"],["cursor"],["padding"],["opacity"],["boxShadow"]],defaultTheme:{cursor:"text",borderRadius:(0,_themeUtils.getBorderRadius)(borderRadius),fontSize:12,border:(0,_themeUtils.getBorder)({color:borderColor,width:borderSize,style:"solid"})},getCSS:function(e,t){var r=t.propsConfig,o=r.placeHolderColor,a=r.placeHolderFont,i=a.size,n=a.weight,l=a.color,s=r.placeHolderFontSize,u=r.resizeType,c=e.width,d=l||o,p=i||(s||12),h=_typeUtils.ObjectUtils.isNumber(c)?px2remcss(c):c,f=u;return checkIsPercent(c)&&(h="100%",f="none"),(0,_themeCssHoc.css)(_templateObject,h,f,d,px2remcss(p),n)},getThemeMeta:function(e,t){var r=e.width,o=e.color,a=e.font;return{color:(a=void 0===a?{}:a).color||o||blackColor,padding:{left:r&&r<200?r/20:padding,right:35,top:6}}}},hover:{selectNames:[["padding"],["border"],["borderRadius"],["cursor"],["background"],["opacity"],["boxShadow"]],defaultTheme:{borderRadius:(0,_themeUtils.getBorderRadius)(borderRadius),border:(0,_themeUtils.getBorder)({color:themeHoverColor,width:borderSize,style:"solid"})}},active:{selectNames:[["boxShadow"],["border"],["borderRadius"],["cursor"],["background"]],defaultTheme:{boxShadow:(0,_themeUtils.getBoxShadow)(hShadow+"px "+vShadow+"px "+shadowSpread+"px "+themeActiveColor)}},disabled:{selectNames:[["fontSize"],["font"],["color"],["background"],["border"],["borderRadius"],["cursor"],["padding"],["opacity"]],defaultTheme:{cursor:"not-allowed",background:{color:disableColor},border:(0,_themeUtils.getBorder)({color:borderColor,width:borderSize,style:"solid"})}},css:(0,_themeCssHoc.css)(_templateObject2,transitionTime)}),TextareaContainer=(0,_themeCssHoc2.default)({tag:"span",className:"TextareaContainer",normal:{selectNames:[["margin"]],getCSS:function(e,t){var r=e.width;return checkIsPercent(r)?"width:"+r+";":""}},hover:{selectNames:[]},click:{selectNames:[]},disabled:{selectNames:[]},css:(0,_themeCssHoc.css)(_templateObject3)}),Clear="lugia-icon-reminder_close",TextAreaBox=function(){function t(e){_classCallCheck(this,t);var i=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return i.actualValue="",i.onFocus=function(e){var t=i.props,r=t.onFocus,o=t.disabled,a=t.readOnly;o||a||r&&r(e)},i.onBlur=function(e){var t=i.props,r=t.onBlur,o=t.disabled,a=t.readOnly;o||a||r&&r(e)},i.onChange=function(e){var t=e.target.value;i.setValue(t,e)},i.onClear=function(e){var t=i.props,r=t.disabled,o=t.onClear;r||(o&&o(e),i.setValue("",e))},i.onKeyDown=function(e){var t=i.props,r=t.onKeyDown,o=t.onEnter;if(!t.disabled){r&&r(e);var a=e.keyCode;o&&13===a&&o(e)}},i.onKeyPress=function(e){var t=i.props,r=t.onKeyPress;t.disabled||r&&r(e)},i.onKeyUp=function(e){var t=i.props,r=t.onKeyUp;t.disabled||r&&r(e)},i.textarea=_react2.default.createRef(),i}return _inherits(t,_react.Component),_createClass(t,[{key:"setValue",value:function(e,t){var r=this.state.value,o=this.props,a=o.disabled,i=o.onChange;if(r!==e&&!a){var n={newValue:e,oldValue:r,event:t};"value"in this.props==!1?this.setState({value:e},function(){i&&i(n)}):i&&i(n)}}},{key:"render",value:function(){return this.getTextareaContainer()}},{key:"getInnerTextarea",value:function(){return[this.generateInput(),this.getClearButton()]}},{key:"getTextareaContainer",value:function(){var e=this.props.getPartOfThemeProps;return _react2.default.createElement(TextareaContainer,Object.assign({},(0,_themeHoc.addMouseEvent)(this),{themeProps:e("Container")}),this.getInnerTextarea())}},{key:"isEmpty",value:function(){var e=this.state.value;return!(e&&e.length)}},{key:"getClearButton",value:function(){var e=this.props.canClear,t=void 0===e||e;if(this.isEmpty()||!t)return null;var r=this.props.getPartOfThemeHocProps("ClearButton"),o=r.theme,a=r.viewClass,i=(0,_objectUtils.deepMerge)(_defineProperty({},a,{normal:{color:mediumGreyColor,fontSize:10,getCSS:function(){return"position: absolute;right:"+px2remcss(padding)+";top:"+px2remcss(8)+";"}},hover:{color:darkGreyColor},disabled:{cursor:"not-allowed"}}),o),n=this.props,l=n.disabled,s=n.clearIcon;return _react2.default.createElement(_icon2.default,Object.assign({disabled:l,singleTheme:!0,viewClass:a,theme:i,iconClass:s||Clear,onClick:this.onClear},(0,_themeHoc.addMouseEvent)(this)))}},{key:"generateInput",value:function(){var e=this.state.value,t=this.props,r=t.placeholder,o=t.autoFocus,a=t.disabled,i=t.resizeType,n=t.validateStatus,l=t.validateType,s=t.getPartOfThemeProps,u=s("Placeholder").themeConfig.normal,c=(u=void 0===u?{}:u).color,d=void 0===c?lightGreyColor:c,p=u.font,h=void 0===p?{}:p,f={validateType:l,validateStatus:n,placeHolderColor:d,placeHolderFontSize:u.fontSize,placeHolderFont:h,resizeType:i},b=s("ValidateErrorInput"),g=(0,_validateHoc.isValidateError)(n)?(0,_objectUtils.deepMerge)(_validateHoc.validateValueDefaultTheme,_validateHoc.validateBorderDefaultTheme,b):{},_=(0,_objectUtils.deepMerge)(s("Container",{props:Object.assign({},f)}),g);return _react2.default.createElement(Textarea,{themeProps:_,autoFocus:o,ref:this.textarea,value:e,onFocus:this.onFocus,onBlur:this.onBlur,onKeyUp:this.onKeyUp,onKeyPress:this.onKeyPress,onKeyDown:this.onKeyDown,onChange:this.onChange,placeholder:r,disabled:a})}}],[{key:"getDerivedStateFromProps",value:function(e,t){var r=e.value,o=e.defaultValue,a="value"in e;return r=(0,_utils.fixControlledValue)(r),t?a?{value:r}:void 0:{value:a?r:o}}}]),t}();TextAreaBox.defaultProps={disabled:!1,autoFocus:!1,defaultValue:"",resizeType:"both"},TextAreaBox.displayName=_index2.default.Textarea;var TargetTxtBox=(0,_themeHoc2.default)((0,_validateHoc3.default)((0,_KeyBoardEventAdaptor2.default)(TextAreaBox),_index2.default.Textarea),_index2.default.Textarea,{hover:!0,active:!0});exports.default=TargetTxtBox;