"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function r(e,t){for(var o=0;o<t.length;o++){var r=t[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,o){return t&&r(e.prototype,t),o&&r(e,o),e}}(),_templateObject=_taggedTemplateLiteral(["\n        &::placeholder {\n          color: ",";\n          font-size: ",";\n          font-weight: ",";\n        }\n      "],["\n        &::placeholder {\n          color: ",";\n          font-size: ",";\n          font-weight: ",";\n        }\n      "]),_templateObject2=_taggedTemplateLiteral(["\n    box-sizing: border-box;\n    line-height: 1.5;\n    display: inline-block;\n    font-family: inherit;\n    transition: all ",";\n    outline: none;\n    height: 100%;\n    width: 100%;\n    border: none;\n  "],["\n    box-sizing: border-box;\n    line-height: 1.5;\n    display: inline-block;\n    font-family: inherit;\n    transition: all ",";\n    outline: none;\n    height: 100%;\n    width: 100%;\n    border: none;\n  "]),_templateObject3=_taggedTemplateLiteral(["\n    position: relative;\n    display: inline-block;\n    outline: none;\n    min-width: ",";\n  "],["\n    position: relative;\n    display: inline-block;\n    outline: none;\n    min-width: ",";\n  "]),_templateObject4=_taggedTemplateLiteral(["\n    position: absolute;\n    transform: translateY(50%);\n    bottom: 50%;\n    line-height: ",";\n    font-size: 1.4em;\n    color: ",";\n  "],["\n    position: absolute;\n    transform: translateY(50%);\n    bottom: 50%;\n    line-height: ",";\n    font-size: 1.4em;\n    color: ",";\n  "]),_templateObject5=_taggedTemplateLiteral(["\n    left: ",";\n  "],["\n    left: ",";\n  "]),_templateObject6=_taggedTemplateLiteral(["\n    right: ",";\n  "],["\n    right: ",";\n  "]);require("../common/shirm");var _KeyBoardEventAdaptor=require("../common/KeyBoardEventAdaptor"),_KeyBoardEventAdaptor2=_interopRequireDefault(_KeyBoardEventAdaptor),_react=require("react"),_react2=_interopRequireDefault(_react),_index=require("../consts/index"),_index2=_interopRequireDefault(_index),_themeHoc=require("@lugia/theme-hoc"),_themeHoc2=_interopRequireDefault(_themeHoc),_utils=require("../utils"),_input=require("../css/input"),_icon=require("../icon"),_icon2=_interopRequireDefault(_icon),_themeCssHoc=require("@lugia/theme-css-hoc"),_themeCssHoc2=_interopRequireDefault(_themeCssHoc),_stateColor=require("../css/stateColor"),_stateColor2=_interopRequireDefault(_stateColor),_css=require("@lugia/css"),_objectUtils=require("@lugia/object-utils"),_themeUtils=require("@lugia/theme-utils"),_typeUtils=require("@lugia/type-utils"),_themeCommonDict=require("../css/theme-common-dict"),_themeCommonDict2=_interopRequireDefault(_themeCommonDict),_MouseEventAdaptor=require("../common/MouseEventAdaptor"),_MouseEventAdaptor2=_interopRequireDefault(_MouseEventAdaptor),_validateHoc=require("./validateHoc"),_validateHoc2=_interopRequireDefault(_validateHoc),_validateHoc3=require("../css/validateHoc");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _defineProperty(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _taggedTemplateLiteral(e,t){return Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var px2remcss=_css.units.px2remcss,_colorsFunc=(0,_stateColor2.default)(),padding=_colorsFunc.padding,shadowSpread=_colorsFunc.shadowSpread,hShadow=_colorsFunc.hShadow,vShadow=_colorsFunc.vShadow,transitionTime=_colorsFunc.transitionTime,borderSize=_colorsFunc.borderSize,themeHoverColor="$lugia-dict.@lugia/lugia-web.themeHoverColor",themeActiveColor="$lugia-dict.@lugia/lugia-web.themeActiveColor",disableColor="$lugia-dict.@lugia/lugia-web.disableColor",borderColor="$lugia-dict.@lugia/lugia-web.borderColor",blackColor="$lugia-dict.@lugia/lugia-web.blackColor",mediumGreyColor="$lugia-dict.@lugia/lugia-web.mediumGreyColor",darkGreyColor="$lugia-dict.@lugia/lugia-web.darkGreyColor",lightGreyColor="$lugia-dict.@lugia/lugia-web.lightGreyColor",borderRadius="$lugia-dict.@lugia/lugia-web.borderRadiusValue",CommonInputStyle=(0,_themeCssHoc2.default)({tag:"input",className:"InnerInput",normal:{selectNames:[["fontSize"],["font"],["color"],["cursor"],["padding"],["borderRadius"],["background"]],defaultTheme:{cursor:"text",fontSize:12,borderRadius:(0,_themeUtils.getBorderRadius)(borderRadius)},getCSS:function(e,t){var o=t.propsConfig,r=o.placeHolderColor,n=o.placeHolderFont,i=(n=void 0===n?{}:n).size,a=n.weight,l=n.color,s=o.placeHolderFontSize,u=l||r,c=s||(i||12);return(0,_themeCssHoc.css)(_templateObject,u,px2remcss(c),a)},getThemeMeta:function(e,t){var o=t.propsConfig,r=o.prefix,n=o.suffix,i=o.isShowClearButton,a=e.width,l=e.color,s=e.font;return{color:(s=void 0===s?{}:s).color||l||blackColor,padding:{left:r?30:a&&a<200?a/20:padding,right:n||i?35:a&&a<200?15+a/10:padding}}}},hover:{selectNames:[["fontSize"],["font"],["color"],["cursor"],["background"]]},active:{selectNames:[["fontSize"],["font"],["color"],["cursor"],["background"]]},disabled:{selectNames:[["fontSize"],["font"],["color"],["cursor"],["opacity"],["background"]],defaultTheme:{cursor:"not-allowed",background:{color:disableColor}}},css:(0,_themeCssHoc.css)(_templateObject2,transitionTime),option:{hover:!0,active:!0}}),InputContainer=(0,_themeCssHoc2.default)({tag:"span",className:"inputContainer",normal:{selectNames:[["width"],["height"],["margin"],["border"],["borderRadius"],["boxShadow"],["background"],["opacity"]],defaultTheme:{width:"100%",borderRadius:(0,_themeUtils.getBorderRadius)(borderRadius),border:(0,_themeUtils.getBorder)({color:borderColor,width:borderSize,style:"solid"})},getThemeMeta:function(e,t){var o=t.propsConfig.size,r=e.height;return{height:(0,_input.getInputHeight)(r,o)}}},hover:{selectNames:[["background"],["border"],["borderRadius"],["boxShadow"],["opacity"]],defaultTheme:{border:(0,_themeUtils.getBorder)({color:themeHoverColor,width:borderSize,style:"solid"})}},active:{selectNames:[["background"],["border"],["borderRadius"],["boxShadow"],["opacity"]],defaultTheme:{border:(0,_themeUtils.getBorder)({color:themeActiveColor,width:borderSize,style:"solid"}),boxShadow:(0,_themeUtils.getBoxShadow)(hShadow+"px "+vShadow+"px "+shadowSpread+"px "+themeActiveColor)}},disabled:{selectNames:[["background"],["border"],["borderRadius"],["boxShadow"],["opacity"]],defaultTheme:{background:{color:disableColor},border:(0,_themeUtils.getBorder)({color:borderColor,width:borderSize,style:"solid"})}},css:(0,_themeCssHoc.css)(_templateObject3,px2remcss(30)),option:{hover:!0,active:!0}}),Fix=(0,_themeCssHoc2.default)({tag:"span",className:"inputFix",normal:{selectNames:[["font"],["color"]]},css:(0,_themeCssHoc.css)(_templateObject4,px2remcss(10),(0,_themeCommonDict2.default)("mediumGreyColor"))}),Prefix=(0,_themeCssHoc2.default)({extend:Fix,className:"inputPrefix",normal:{selectNames:[["font"],["fontSize"],["color"]]},css:(0,_themeCssHoc.css)(_templateObject5,px2remcss(padding))}),Suffix=(0,_themeCssHoc2.default)({extend:Fix,className:"inputSuffix",normal:{selectNames:[["font"],["fontSize"],["color"]]},css:(0,_themeCssHoc.css)(_templateObject6,px2remcss(padding))}),Clear="lugia-icon-reminder_close",TextBox=function(){function t(e){_classCallCheck(this,t);var l=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return l.onChange=function(e){var t=e.target.value;l.setValue(t,e)},l.onFocus=function(e){var t=l.props,o=t.onFocus,r=t.disabled,n=t.readOnly;r||n||o&&o(e)},l.onBlur=function(e){var t=l.props,o=t.onBlur,r=t.disabled,n=t.readOnly;r||n||o&&o(e)},l.onClear=function(e){var t=l.props,o=t.disabled,r=t.onClear,n=t.readOnly;o||n||(r&&r(e),l.setValue("",e))},l.onMouseLeave=function(e){var t=l.props,o=t.disabled,r=t.onMouseLeave;o||r&&r(e)},l.onMouseEnter=function(e){var t=l.props,o=t.disabled,r=t.onMouseEnter;o||r&&r(e)},l.onKeyDown=function(e){var t=l.props,o=t.onKeyDown,r=t.onEnter,n=t.disabled,i=t.readOnly;if(!n&&!i){o&&o(e);var a=e.keyCode;r&&13===a&&r(e)}},l.onClick=function(e){var t=l.props,o=t.onClick,r=t.disabled,n=t.readOnly;r||n||o&&o(e)},l.onKeyPress=function(e){var t=l.props,o=t.onKeyPress,r=t.disabled,n=t.readOnly;r||n||o&&o(e)},l.onKeyUp=function(e){var t=l.props,o=t.onKeyUp,r=t.disabled,n=t.readOnly;r||n||o&&o(e)},l.input=_react2.default.createRef(),l}return _inherits(t,_react.Component),_createClass(t,[{key:"getRef",value:function(){return this.input}},{key:"setValue",value:function(e,t){var o=this.state.value,r=this.props,n=r.disabled,i=r.onChange,a=r.parser,l=r.formatter,s=r.readOnly;if(o!==e&&!n&&!s){l&&a&&(e=a(e));var u={newValue:e,oldValue:o,event:t};"value"in this.props==!1?this.setState({value:e},function(){i&&i(u)}):i&&i(u)}}},{key:"isEmpty",value:function(){var e=this.state.value;return!(e&&e.length)}},{key:"getInputContainer",value:function(){return _react2.default.createElement(InputContainer,{themeProps:this.getFinalThemeProps()},this.generatePrefix(),this.generateInput(),this.generateSuffix())}},{key:"render",value:function(){return this.getInputContainer()}},{key:"componentDidMount",value:function(){var e=this.props.getInputRef;e&&e({ref:this.getRef()})}},{key:"getFixIcon",value:function(e,t){return _typeUtils.ObjectUtils.isString(e)?_react2.default.createElement(_icon2.default,Object.assign({singleTheme:!0},this.props.getPartOfThemeHocProps(t),{iconClass:e})):e}},{key:"generatePrefix",value:function(){var e=this.props,t=e.prefix,o=(0,e.getPartOfThemeProps)("InputPrefix");return t?_react2.default.createElement(Prefix,{themeProps:o},this.getFixIcon(t,"InputPrefix")):null}},{key:"generateSuffix",value:function(){var e=this.props,t=e.suffix,o=e.getPartOfThemeProps;return t?_react2.default.createElement(Suffix,{themeProps:o("InputSuffix")},this.getFixIcon(t,"InputSuffix")):this.props.isShowClearButton?this.getClearButton():null}},{key:"getClearButton",value:function(){var e=this.props.canClear,t=void 0===e||e;if(this.isEmpty()||!t)return null;var o=this.props.getPartOfThemeHocProps("ClearButton"),r=o.theme,n=o.viewClass,i=(0,_objectUtils.deepMerge)(_defineProperty({},n,{normal:{color:mediumGreyColor,getCSS:function(){return" position: absolute;\n                   transform: translateY(50%);\n                   bottom: 50%;\n                   right: "+px2remcss(padding)+";"}},hover:{color:darkGreyColor},disabled:{cursor:"not-allowed"}}),r),a=this.props,l=a.disabled,s=a.clearIcon;return _react2.default.createElement(_icon2.default,{disabled:l,singleTheme:!0,viewClass:n,theme:i,iconClass:s||Clear,onClick:this.onClear})}},{key:"generateInput",value:function(){var e=this.props,t=this.state.value,o=e.suffix,r=e.prefix,n=e.size,i=e.formatter,a=e.parser,l=e.validateStatus,s=e.validateType,u=e.placeholder,c=e.readOnly,d=e.autoFocus,p=e.type,f=e.disabled,h=e._maxLength;i&&a&&(t=i(t));var m="password"===p?"password":"text",g={enter:this.onMouseEnter,leave:this.onMouseLeave};return _react2.default.createElement(CommonInputStyle,Object.assign({},(0,_themeHoc.addMouseEvent)(this,g),{maxLength:h,themeProps:this.getFinalThemeProps(),autoFocus:d,ref:this.input,validateStatus:l,validateType:s,suffix:o,prefix:r,value:t,size:n,onKeyUp:this.onKeyUp,onKeyPress:this.onKeyPress,onKeyDown:this.onKeyDown,onFocus:this.onFocus,onBlur:this.onBlur,onClick:this.onClick,onChange:this.onChange,formatter:i,parser:a,readOnly:c,type:m,placeholder:u,disabled:f}))}},{key:"getFinalThemeProps",value:function(){var e=this.props,t=e.getPartOfThemeProps,o=e.validateStatus,r=e.prefix,n=e.suffix,i=e.isShowClearButton,a=e.size,l=t("Placeholder").themeConfig.normal,s=(l=void 0===l?{}:l).color,u=void 0===s?lightGreyColor:s,c=l.font,d=void 0===c?{}:c,p=l.fontSize,f=t("ValidateErrorInput"),h=(0,_validateHoc3.isValidateError)(o)?(0,_objectUtils.deepMerge)(_validateHoc3.validateValueDefaultTheme,_validateHoc3.validateBorderDefaultTheme,f):{};return(0,_objectUtils.deepMerge)(t("Input",{props:{prefix:r,suffix:n,placeHolderColor:u,placeHolderFontSize:p,isShowClearButton:i,placeHolderFont:d}}),t("Container",{props:{size:a}}),h)}}],[{key:"getDerivedStateFromProps",value:function(e,t){var o=e.value,r=e.defaultValue,n="value"in e;return o=(0,_utils.fixControlledValue)(o),t?n?{value:o}:void 0:{value:n?o:r}}}]),t}();TextBox.defaultProps={disabled:!1,autoFocus:!1,viewClass:_index2.default.Input,size:"default",defaultValue:"",isShowClearButton:!0,formatter:function(e){return e},parser:function(e){return e}},TextBox.displayName=_index2.default.Input;var TargetTxtBox=(0,_themeHoc2.default)((0,_validateHoc2.default)((0,_MouseEventAdaptor2.default)((0,_KeyBoardEventAdaptor2.default)(TextBox))),_index2.default.Input,{hover:!0,active:!0});exports.default=TargetTxtBox;