"use strict";var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _classCallCheck2=_interopRequireDefault(require("@babel/runtime/helpers/classCallCheck")),_createClass2=_interopRequireDefault(require("@babel/runtime/helpers/createClass")),_lugiaxCommon=require("@lugia/lugiax-common"),_stack=_interopRequireDefault(require("./stack")),BatchModels="batchModels",Render=function(){function e(){var r=this;(0,_classCallCheck2.default)(this,e),this.renderEvent=void 0,this.renderCollector=void 0,this.willRenderModules={},this.beginCall=function(e){r.renderCollector.push(e)},this.endCall=function(){r.renderCollector.pop()},this.onAfterPush=function(e){r.willRenderModules[e]=!0},this.onAfterPop=function(){r.autoRender()},this.clear()}return(0,_createClass2.default)(e,[{key:"onRender",value:function(e,r){return this.renderEvent.subscribe(e,r)}},{key:"clear",value:function(){this.renderEvent=new _lugiaxCommon.Subscribe,this.renderCollector=new _stack.default({onPushItem:this.onAfterPush,onStackEmpty:this.onAfterPop}),this.willRenderModules={}}},{key:"clearRenderModules",value:function(){this.willRenderModules={}}},{key:"autoRender",value:function(){var e=this.willRenderModules;this.clearRenderModules(),this.trigger(e)}},{key:"trigger",value:function(e){this.renderEvent.trigger(BatchModels,e)}}]),e}(),_default=new Render;exports.default=_default,module.exports=exports.default;